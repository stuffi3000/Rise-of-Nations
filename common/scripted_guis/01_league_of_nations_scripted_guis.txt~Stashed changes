scripted_gui = {
	open_league_of_nations_window = {
		context_type = player_context

		window_name = "open_league_of_nations_window"
		parent_window_token = top_bar

		visible = {
			is_ai = no
			any_country = {
				has_country_flag = leader_of_league_of_nations
			}
		}

		effects = {
			open_league_of_nations_window_button_click = {
				set_temp_variable = { show = 1 }
				subtract_from_temp_variable = { show = show_league_of_nations }
				set_variable = { show_league_of_nations = show }
				set_variable = { show_league_of_nations_start_voting_country_list = 0 }
				clear_array = league_of_nations_possible_voting_targets_array
			}
			open_league_of_nations_window_button_control_right_click = {
				set_variable = { dont_show_league_of_nations_map_mode_legend = 0 }
				if = {
					limit = {
						NOT = { has_global_flag = league_of_nations_map_mode_active }
					}
					every_country = {
						limit = {
							has_country_flag = leader_of_league_of_nations
						}
						save_cosmetic_tag_before_league_of_nations_map_mode = yes
						set_cosmetic_tag = LEAGUE_OF_NATIONS_LEADER_CT
					}
					every_country = {
						limit = {
							NOT = { has_country_flag = leader_of_league_of_nations }
							has_country_flag = member_of_league_of_nations
						}
						save_cosmetic_tag_before_league_of_nations_map_mode = yes
						set_cosmetic_tag = LEAGUE_OF_NATIONS_MEMBER_CT
					}
					every_country = {
						limit = {
							NOT = { has_country_flag = member_of_league_of_nations }
						}
						save_cosmetic_tag_before_league_of_nations_map_mode = yes
						set_cosmetic_tag = NOT_LEAGUE_OF_NATIONS_MEMBER_CT
					}
					every_country = {
						limit = {
							has_country_flag = started_league_of_nations_voting
						}
						save_cosmetic_tag_before_league_of_nations_map_mode = yes
						set_cosmetic_tag = LEAGUE_OF_NATIONS_STARTER_OF_VOTING_CT
					}
					every_country = {
						limit = {
							has_country_flag = target_of_league_of_nations_voting
						}
						save_cosmetic_tag_before_league_of_nations_map_mode = yes
						if = {
							limit = {
								has_country_flag = member_of_league_of_nations
							}
							set_cosmetic_tag = LEAGUE_OF_NATIONS_TARGET_OF_VOTING_CT_MEMBER_CT
						}
						else = {
							set_cosmetic_tag = LEAGUE_OF_NATIONS_TARGET_OF_VOTING_CT
						}
					}
					set_global_flag = league_of_nations_map_mode_active
					set_variable = { y_position_of_leave_league_of_nations_map_mode_button = 200 }
				}
				else = {
					every_country = {
						remove_league_of_nations_map_mode_tags = yes
					}
					clr_global_flag = league_of_nations_map_mode_active
				}
			}
		}

		triggers = {
			open_league_of_nations_window_icon_glow_visible = {
				has_global_flag = league_of_nations_voting
			}
			open_league_of_nations_window_icon_glow_frame_visible = {
				has_country_flag = leader_of_league_of_nations
				NOT = { has_global_flag = league_of_nations_focus_active }
				OR = {
					AND = {
						NOT = { has_global_flag = league_of_nations_focus_1_selected }
						NOT = { has_global_flag = league_of_nations_focus_1_completed }
					}
					AND = {
						has_global_flag = league_of_nations_focus_1_completed
						NOT = { has_global_flag = league_of_nations_focus_2_selected }
						NOT = { has_global_flag = league_of_nations_focus_2_completed }
						NOT = { has_global_flag = league_of_nations_focus_3_selected }
						NOT = { has_global_flag = league_of_nations_focus_3_completed }
						check_variable = { global.num_of_total_successful_league_of_nations_votings > 2 }
					}
					AND = {
						has_global_flag = league_of_nations_focus_1_completed
						NOT = { has_global_flag = league_of_nations_focus_2_selected }
						NOT = { has_global_flag = league_of_nations_focus_2_completed }
						NOT = { has_global_flag = league_of_nations_focus_3_selected }
						NOT = { has_global_flag = league_of_nations_focus_3_completed }
						check_variable = { global.num_of_total_successful_league_of_nations_votings > 2 }
					}
					AND = {
						has_global_flag = league_of_nations_focus_2_completed
						NOT = { has_global_flag = league_of_nations_focus_4_selected }
						NOT = { has_global_flag = league_of_nations_focus_4_completed }
						date > 1939.09.17
					}
					AND = {
						has_global_flag = league_of_nations_focus_3_completed
						NOT = { has_global_flag = league_of_nations_focus_5_selected }
						NOT = { has_global_flag = league_of_nations_focus_5_completed }
						date > 1939.09.17
					}
					AND = {
						OR = {
							has_global_flag = league_of_nations_focus_4_completed
							has_global_flag = league_of_nations_focus_5_completed
						}
						NOT = { has_global_flag = league_of_nations_focus_6_selected }
						NOT = { has_global_flag = league_of_nations_focus_6_completed }
						date > 1942.09.17
						check_variable = { num_of_won_league_of_nations_elections > 2 }
					}
					AND = {
						has_global_flag = league_of_nations_focus_4_completed
						has_global_flag = league_of_nations_focus_6_completed
						NOT = { has_global_flag = league_of_nations_focus_7_selected }
						NOT = { has_global_flag = league_of_nations_focus_7_completed }
						date > 1945.09.17
						has_war = no
					}
					AND = {
						has_global_flag = league_of_nations_focus_5_completed
						has_global_flag = league_of_nations_focus_6_completed
						NOT = { has_global_flag = league_of_nations_focus_8_selected }
						NOT = { has_global_flag = league_of_nations_focus_8_completed }
						date > 1945.09.17
						has_war = no
					}
				}
			}
		}
	}

	league_of_nations_window = {
		context_type = player_context

		window_name = "league_of_nations_window"

		visible = {
			ROOT = {
				OR = {
					AND = {
						is_ai = yes
						has_country_flag = member_of_league_of_nations
					}
					check_variable = { show_league_of_nations > 0 }
				}
			}
			any_country = {
				has_country_flag = leader_of_league_of_nations
			}
		}

		effects = {
			league_of_nations_voting_yes_click = {
				set_country_flag = league_of_nations_voted_yes
				add_to_variable = { global.num_of_yes_votes_in_league_of_nations_voting = 1 }
				if = {
					limit = {
						has_country_flag = leader_of_league_of_nations
					}
					add_to_variable = { global.num_of_yes_votes_in_league_of_nations_voting = 2 }
				}
			}
			league_of_nations_voting_no_click = {
				set_country_flag = league_of_nations_voted_no
				add_to_variable = { global.num_of_no_votes_in_league_of_nations_voting = 1 }
				if = {
					limit = {
						has_country_flag = leader_of_league_of_nations
					}
					add_to_variable = { global.num_of_no_votes_in_league_of_nations_voting = 2 }
				}
			}
			league_of_nations_close_button_click = {
				set_variable = { show_league_of_nations = 0 }
				set_variable = { show_league_of_nations_start_voting_country_list = 0 }
			}
			league_of_nations_leave_button_click = {
				country_event = { id = league_of_nations_events.3 }
				news_event = { id = league_of_nations_news_events.5 }
			}
			league_of_nations_noconfidence_vote_button_click = {
				set_country_flag = voted_in_noconfidence_vote
				add_to_variable = { global.num_of_league_of_nations_noconfidence_votes = 1 }
			}
			league_of_nations_noconfidence_vote_button_selected_click = {
				clr_country_flag = voted_in_noconfidence_vote
				subtract_from_variable = { global.num_of_league_of_nations_noconfidence_votes = 1 }
			}
			league_of_nations_button_click = {
				set_temp_variable = { show = 1 }
				subtract_from_temp_variable = { show = show_league_of_nations_focuses }
				set_variable = { show_league_of_nations_focuses = show }
			}
			league_of_nations_start_voting_button_click = {
				set_temp_variable = { show = 1 }
				subtract_from_temp_variable = { show = show_league_of_nations_start_voting_country_list }
				set_variable = { show_league_of_nations_start_voting_country_list = show }
				if = {
					limit = {
						check_variable = { show_league_of_nations_start_voting_country_list > 0 }
					}
					every_other_country = {
						limit = {
							NOT = { is_in_array = { ROOT.league_of_nations_possible_voting_targets_array = THIS.id } }
							check_variable = { num_of_active_league_of_nations_trade_sanctions < 10 }
							NOT = { has_country_flag = leader_of_league_of_nations }
							check_variable = { cooldown_for_league_of_nations_voting < 1 }
							NOT = { check_variable = { league_of_nations_generated_threat < 10 } }
						}
						add_to_array = { ROOT.league_of_nations_possible_voting_targets_array = THIS.id }
					}
					sort_array_high_to_low_league_of_nations_possible_voting_targets_array = yes
				}
				else_if = {
					limit = {
						always = yes
					}
					clear_array = league_of_nations_possible_voting_targets_array
				}
			}
			leader_flag_click = {
				event_target:league_of_nations_leader = {
					capital_scope = {
						ROOT = {
							goto_state = PREV
						}
					}
				}
			}
			# Member list:
			member_flag_click = {
				capital_scope = {
					ROOT = {
						goto_state = PREV
					}
				}
			}
			vote_for_member_button_click = {
				if = {
					limit = {
						ROOT = {
							has_variable = elected_country_for_lon_leader
						}
					}
					var:ROOT.elected_country_for_lon_leader = {
						subtract_from_variable = { num_of_votes_for_lon_election = 1 }
					}
				}
				add_to_variable = { num_of_votes_for_lon_election = 1 }
				ROOT = {
					set_variable = { elected_country_for_lon_leader = PREV.id }
				}
				random_country = {
					limit = {
						has_country_flag = member_of_league_of_nations
						NOT = {
							any_other_country = {
								has_country_flag = member_of_league_of_nations
								check_variable = { num_of_votes_for_lon_election > PREV.num_of_votes_for_lon_election }
							}
						}
					}
					set_variable = { global.next_possible_lon_leader = THIS.id }
					set_variable = { global.next_possible_lon_leader_votes = num_of_votes_for_lon_election }
				}
			}
			remove_vote_for_member_button_click = {
				subtract_from_variable = { num_of_votes_for_lon_election = 1 }
				ROOT = {
					clear_variable = elected_country_for_lon_leader
				}
				if = {
					limit = {
						any_country = {
							has_country_flag = member_of_league_of_nations
							check_variable = { num_of_votes_for_lon_election > 0 }
						}
					}
					random_country = {
						limit = {
							has_country_flag = member_of_league_of_nations
							NOT = {
								any_other_country = {
									has_country_flag = member_of_league_of_nations
									check_variable = { num_of_votes_for_lon_election > PREV.num_of_votes_for_lon_election }
								}
							}
						}
						set_variable = { global.next_possible_lon_leader = THIS.id }
						set_variable = { global.next_possible_lon_leader_votes = num_of_votes_for_lon_election }
					}
				}
				else_if = {
					limit = {
						always = yes
					}
					clear_variable = global.next_possible_lon_leader
					clear_variable = global.next_possible_lon_leader_votes
				}
			}
		}

		triggers = {
			league_of_nations_voting_yes_click_enabled = {
				check_variable = { global.league_of_nations_voting_time > 0 }
				NOT = { has_country_flag = started_league_of_nations_voting }
				NOT = { has_country_flag = target_of_league_of_nations_voting }
				NOT = { has_country_flag = league_of_nations_voted_yes }
				NOT = { has_country_flag = league_of_nations_voted_no }
				has_country_flag = member_of_league_of_nations
			}
			league_of_nations_voting_no_click_enabled = {
				check_variable = { global.league_of_nations_voting_time > 0 }
				NOT = { has_country_flag = started_league_of_nations_voting }
				NOT = { has_country_flag = target_of_league_of_nations_voting }
				NOT = { has_country_flag = league_of_nations_voted_yes }
				NOT = { has_country_flag = league_of_nations_voted_no }
				has_country_flag = member_of_league_of_nations
			}
			league_of_nations_voting_yes_visible = {
				has_global_flag = league_of_nations_voting
			}
			league_of_nations_voting_yes_button_text_visible = {
				has_global_flag = league_of_nations_voting
			}
			league_of_nations_voting_no_visible = {
				has_global_flag = league_of_nations_voting
			}
			league_of_nations_voting_no_button_text_visible = {
				has_global_flag = league_of_nations_voting
			}
			league_of_nations_voting_info_box_bg_visible = {
				has_global_flag = league_of_nations_voting
			}
			league_of_nations_voting_info_box_text_visible = {
				has_global_flag = league_of_nations_voting
			}
			league_of_nations_leave_button_click_enabled = {
				has_country_flag = member_of_league_of_nations
				NOT = { has_country_flag = leader_of_league_of_nations }
				NOT = { has_global_flag = league_of_nations_voting }
				check_variable = { global.days_til_next_league_of_nations_election > 10 }
				NOT = { has_global_flag = league_of_nations_election }
			}
			league_of_nations_voting_yes_glow_visible = {
				has_global_flag = league_of_nations_voting
				has_country_flag = league_of_nations_voted_yes
			}
			league_of_nations_voting_no_glow_visible = {
				has_global_flag = league_of_nations_voting
				has_country_flag = league_of_nations_voted_no
			}
			league_of_nations_noconfidence_vote_button_click_enabled = {
				check_variable = { global.days_til_next_league_of_nations_election > 10 }
				NOT = { has_country_flag = leader_of_league_of_nations }
				NOT = { has_global_flag = league_of_nations_election }
				has_variable = elected_country_for_lon_leader
			}
			league_of_nations_noconfidence_vote_button_selected_click_enabled = {
				check_variable = { global.days_til_next_league_of_nations_election > 10 }
				NOT = { has_country_flag = leader_of_league_of_nations }
				NOT = { has_global_flag = league_of_nations_election }
			}
			league_of_nations_noconfidence_vote_button_visible = {
				has_country_flag = member_of_league_of_nations
				NOT = { has_global_flag = league_of_nations_voting }
				NOT = { has_country_flag = voted_in_noconfidence_vote }
				NOT = { has_global_flag = league_of_nations_focus_6_completed }
			}
			league_of_nations_noconfidence_vote_button_selected_visible = {
				has_country_flag = member_of_league_of_nations
				NOT = { has_global_flag = league_of_nations_voting }
				has_country_flag = voted_in_noconfidence_vote
				NOT = { has_global_flag = league_of_nations_focus_6_completed }
			}
			league_of_nations_noconfidence_vote_button_text_visible = {
				NOT = { has_global_flag = league_of_nations_voting }
				NOT = { has_global_flag = league_of_nations_focus_6_completed }
			}
			league_of_nations_noconfidence_vote_info_box_bg_visible = {
				NOT = { has_global_flag = league_of_nations_voting }
				NOT = { has_global_flag = league_of_nations_focus_6_completed }
			}
			league_of_nations_noconfidence_vote_info_box_text_visible = {
				NOT = { has_global_flag = league_of_nations_voting }
				NOT = { has_global_flag = league_of_nations_focus_6_completed }
			}
			league_of_nations_start_voting_button_click_enabled = {
				has_country_flag = member_of_league_of_nations
				check_variable = { global.time_til_next_possible_league_of_nations_voting < 1 }
				NOT = { has_global_flag = league_of_nations_election }
				NOT = { has_global_flag = GER_anschluss_voting_in_queue }
				NOT = { has_global_flag = SOV_FIN_voting_triggered }
				NOT = { has_global_flag = league_of_nations_voting }
				OR = {
					check_variable = { global.days_til_next_league_of_nations_election > 70 }
					has_global_flag = league_of_nations_focus_6_completed
				}
				any_other_country = {
					NOT = { has_country_flag = leader_of_league_of_nations }
					check_variable = { num_of_active_league_of_nations_trade_sanctions < 10 }
					check_variable = { cooldown_for_league_of_nations_voting < 1 }
					NOT = { check_variable = { league_of_nations_generated_threat < 10 } }
				}
			}
			league_of_nations_start_voting_button_visible = {
				has_country_flag = member_of_league_of_nations
			}
			league_of_nations_info_button_visible = {
				is_ai = no
			}
			# Member list:
			league_of_nations_member_entry_bg_grey_visible = {
				OR = {
					has_country_flag = target_of_league_of_nations_voting
					has_country_flag = started_league_of_nations_voting
				}
			}
			league_of_nations_member_entry_bg_green_visible = {
				has_country_flag = league_of_nations_voted_yes
			}
			league_of_nations_member_entry_bg_red_visible = {
				has_country_flag = league_of_nations_voted_no
			}
			vote_for_member_button_visible = {
				NOT = { has_global_flag = league_of_nations_focus_6_completed }
				ROOT = {
					OR = {
						NOT = { has_variable = elected_country_for_lon_leader }
						NOT = { check_variable = { elected_country_for_lon_leader = PREV.id } }
					}
					has_country_flag = member_of_league_of_nations
				}
			}
			vote_for_member_button_click_enabled = {
				NOT = { check_variable = { global.days_til_next_league_of_nations_election < 5 } }
			}
			remove_vote_for_member_button_visible = {
				NOT = { has_global_flag = league_of_nations_focus_6_completed }
				ROOT = {
					has_variable = elected_country_for_lon_leader
					check_variable = { elected_country_for_lon_leader = PREV.id }
					has_country_flag = member_of_league_of_nations
				}
			}
			remove_vote_for_member_button_click_enabled = {
				NOT = { check_variable = { global.days_til_next_league_of_nations_election < 5 } }
			}
		}

		dynamic_lists = {
			league_of_nations_members_list_gridbox = {
				array = global.members_of_league_of_nation_array
				entry_container = league_of_nations_member_list_entry
				change_scope = yes

				ai_weights = {
					vote_for_member_button_click = {
						ai_will_do = {
							factor = 0

							modifier = {
								has_global_flag = league_of_nations_voting
								ROOT = {
									NOT = { has_country_flag = league_of_nations_voted_yes }
									NOT = { has_country_flag = league_of_nations_voted_no }
								}
								factor = 0
							}
							modifier = {
								tag = ROOT
								has_capitulated = no
								ROOT = {
									NOT = { check_variable = { elected_country_for_lon_leader = ROOT.id } }
									check_variable = { num_of_votes_for_lon_election > 0 }
								}
								add = 100
							}
							modifier = {
								all_country = {
									if = {
										limit = {
											has_country_flag = member_of_league_of_nations
										}
										ROOT = {
											set_temp_variable = { ai_election_value_of_@PREV = opinion@PREV }
											if = {
												limit = {
													has_government = PREV
												}
												add_to_temp_variable = { ai_election_value_of_@PREV = 10 }
											}
											if = {
												limit = {
													OR = {
														AND = {
															PREV = { has_government = fascism }
															NOT = { has_government = fascism }
														}
														AND = {
															PREV = { has_government = communism }
															NOT = { has_government = communism }
														}
													}
												}
												subtract_from_temp_variable = { ai_election_value_of_@PREV = 50 }
											}
											if = {
												limit = {
													is_in_faction_with = PREV
												}
												add_to_temp_variable = { ai_election_value_of_@PREV = 20 }
											}
											if = {
												limit = {
													is_subject_of = PREV
												}
												if = {
													limit = {
														check_variable = { PREV.elected_country_for_lon_leader = PREV.id }
													}
													add_to_temp_variable = { ai_election_value_of_@PREV = 1000 }
												}
											}
											else_if = {
												limit = {
													is_subject = yes
													overlord = {
														check_variable = { elected_country_for_lon_leader = PREV.PREV }
													}
												}
												add_to_temp_variable = { ai_election_value_of_@PREV = 1000 }
											}
											if = {
												limit = {
													PREV = { has_country_flag = leader_of_league_of_nations }
												}
												add_to_temp_variable = { ai_election_value_of_@PREV = 5 }
												if = {
													limit = {
														has_country_flag = voted_in_noconfidence_vote
													}
													subtract_from_temp_variable = { ai_election_value_of_@PREV = 1000 }
												}
											}
											if = {
												limit = {
													PREV = { check_variable = { league_of_nations_generated_threat > 0 } }
												}
												subtract_from_temp_variable = { ai_election_value_of_@PREV = league_of_nations_generated_threat }
											}
											if = {
												limit = {
													PREV = { is_major = yes }
												}
												add_to_temp_variable = { ai_election_value_of_@PREV = 15 }
											}
											if = {
												limit = {
													PREV = { is_subject = yes }
												}
												subtract_from_temp_variable = { ai_election_value_of_@PREV = 200 }
											}
											if = {
												limit = {
													PREV = { has_capitulated = yes }
												}
												subtract_from_temp_variable = { ai_election_value_of_@PREV = 1000 }
											}
										}
									}
								}
								NOT = {
									any_other_country = {
										has_country_flag = member_of_league_of_nations
										check_variable = { ai_election_value_of_@THIS > ai_election_value_of_@PREV }
									}
								}
								add = 10
							}
							modifier = {
								tag = ROOT
								all_country = {
									if = {
										limit = {
											has_country_flag = member_of_league_of_nations
										}
										ROOT = {
											set_temp_variable = { ai_election_value_of_@PREV = opinion@PREV }
											if = {
												limit = {
													has_government = PREV
												}
												add_to_temp_variable = { ai_election_value_of_@PREV = 10 }
											}
											if = {
												limit = {
													OR = {
														AND = {
															PREV = { has_government = fascism }
															NOT = { has_government = fascism }
														}
														AND = {
															PREV = { has_government = communism }
															NOT = { has_government = communism }
														}
													}
												}
												subtract_from_temp_variable = { ai_election_value_of_@PREV = 50 }
											}
											if = {
												limit = {
													is_in_faction_with = PREV
												}
												add_to_temp_variable = { ai_election_value_of_@PREV = 20 }
											}
											if = {
												limit = {
													is_subject_of = PREV
												}
												if = {
													limit = {
														check_variable = { PREV.elected_country_for_lon_leader = PREV.id }
													}
													add_to_temp_variable = { ai_election_value_of_@PREV = 1000 }
												}
											}
											else_if = {
												limit = {
													is_subject = yes
													overlord = {
														check_variable = { elected_country_for_lon_leader = PREV.PREV }
													}
												}
												add_to_temp_variable = { ai_election_value_of_@PREV = 1000 }
											}
											if = {
												limit = {
													PREV = { has_country_flag = leader_of_league_of_nations }
												}
												add_to_temp_variable = { ai_election_value_of_@PREV = 5 }
												if = {
													limit = {
														has_country_flag = voted_in_noconfidence_vote
													}
													subtract_from_temp_variable = { ai_election_value_of_@PREV = 1000 }
												}
											}
											if = {
												limit = {
													PREV = { check_variable = { league_of_nations_generated_threat > 0 } }
												}
												subtract_from_temp_variable = { ai_election_value_of_@PREV = league_of_nations_generated_threat }
											}
											if = {
												limit = {
													PREV = { is_major = yes }
												}
												add_to_temp_variable = { ai_election_value_of_@PREV = 15 }
											}
											if = {
												limit = {
													PREV = { is_subject = yes }
												}
												subtract_from_temp_variable = { ai_election_value_of_@PREV = 50 }
											}
											if = {
												limit = {
													PREV = { has_capitulated = yes }
												}
												subtract_from_temp_variable = { ai_election_value_of_@PREV = 1000 }
											}
										}
									}
								}
								all_country = {
									OR = {
										tag = ROOT
										NOT = { has_country_flag = member_of_league_of_nations }
										check_variable = { ai_election_value_of_@THIS < 1 }
									}
								}
								add = 1
							}
							modifier = {
								has_capitulated = yes
								factor = 0
							}
						}
					}
					remove_vote_for_member_button_click = {
						ai_will_do = {
							factor = 0
						}
					}
				}
			}
		}

		properties = {
			leader_flag = {
				image = "[league_of_nations_leader.GetFlag]"
			}
			member_flag = {
				image = "[This.GetFlag]"
			}
		}

		ai_enabled = {
			always = yes
		}

		ai_test_interval = 336
		ai_test_variance = 0.5

		ai_check = {
			has_country_flag = member_of_league_of_nations
		}

		ai_weights = {
			leader_flag_click = {
				ai_will_do = {
					factor = 0
				}
			}
			league_of_nations_start_voting_button_click = {
				ai_will_do = {
					factor = 0
				}
			}
			league_of_nations_button_click = {
				ai_will_do = {
					factor = 0
				}
			}
			league_of_nations_voting_yes_click = {
				ai_will_do = {
					factor = 0

					modifier = {
						surrender_progress > 0.5
						any_country = {
							has_country_flag = target_of_league_of_nations_voting
							has_war_with = ROOT
						}
						add = 50
					}
					modifier = {
						any_country = {
							has_country_flag = target_of_league_of_nations_voting
							has_offensive_war = yes
						}
						add = 10
					}
					modifier = {
						any_country = {
							has_country_flag = target_of_league_of_nations_voting
							ROOT = {
								has_opinion = {
									target = PREV
									value < 0
								}
							}
						}
						add = 5
					}
					modifier = {
						any_country = {
							has_country_flag = started_league_of_nations_voting
							ROOT = {
								has_opinion = {
									target = PREV
									value > 50
								}
							}
						}
						add = 5
					}
					modifier = {
						has_capitulated = yes
						any_owned_state = {
							NOT = { is_controlled_by = ROOT }
							controller = {
								has_war_with = ROOT
								has_country_flag = target_of_league_of_nations_voting
							}
						}
						add = 100
					}
					modifier = {
						check_variable = { league_of_nations_neutrality_random_chance_in_voting = 1 }
						add = 5
					}
					modifier = {
						check_variable = { league_of_nations_neutrality_random_chance_in_voting = 2 }
						add = 10
					}
					modifier = {
						check_variable = { league_of_nations_neutrality_random_chance_in_voting = 3 }
						add = 20
					}
					modifier = {
						any_neighbor_country = {
							has_country_flag = target_of_league_of_nations_voting
							NOT = { check_variable = { league_of_nations_generated_threat < 40 } }
						}
						add = 10
					}
					modifier = {
						any_country = {
							has_country_flag = target_of_league_of_nations_voting
							NOT = { is_neighbor_of = ROOT }
							NOT = { check_variable = { league_of_nations_generated_threat < 40 } }
						}
						add = 5
					}
					modifier = {
						any_neighbor_country = {
							has_country_flag = target_of_league_of_nations_voting
							OR = {
								has_war_with = ROOT
								NOT = { check_variable = { league_of_nations_generated_threat < 20 } }
								ROOT = {
									has_opinion = {
										target = PREV
										value < 0
									}
								}
							}
						}
						add = 10
					}
					modifier = {
						any_country = {
							has_country_flag = target_of_league_of_nations_voting
							NOT = { is_neighbor_of = ROOT }
							OR = {
								has_war_with = ROOT
								NOT = { check_variable = { league_of_nations_generated_threat < 20 } }
								ROOT = {
									has_opinion = {
										target = PREV
										value < 0
									}
								}
							}
						}
						add = 5
					}
					modifier = {
						has_global_flag = ITA_ETH_voting
						add = 4
					}
					modifier = {
						any_country = {
							has_country_flag = target_of_league_of_nations_voting
							has_country_flag = last_league_of_nations_threat_static_change
							has_country_flag = {
								flag = last_league_of_nations_threat_static_change
								days < 40
							}
							OR = {
								check_variable = { last_league_of_nations_threat_static_change = 1 }
								check_variable = { last_league_of_nations_threat_static_change = 2 }
							}
						}
						add = 3
					}
					modifier = {
						has_global_flag = league_of_nations_always_vote_yes_cheat_flag
						add = 10000
					}
					modifier = {
						any_other_country = {
							is_justifying_wargoal_against = LON
						}
						add = 100
					}
				}
			}
			league_of_nations_voting_no_click = {
				ai_will_do = {
					factor = 0

					modifier = {
						check_variable = { league_of_nations_neutrality_random_chance_in_voting = 4 }
						add = 5
					}
					modifier = {
						check_variable = { league_of_nations_neutrality_random_chance_in_voting = 5 }
						add = 10
					}
					modifier = {
						check_variable = { league_of_nations_neutrality_random_chance_in_voting = 6 }
						add = 20
					}
					modifier = {
						any_country = {
							has_country_flag = target_of_league_of_nations_voting
							NOT = { is_neighbor_of = ROOT }
							OR = {
								has_war_with = ROOT
								NOT = { check_variable = { league_of_nations_generated_threat < 20 } }
								ROOT = {
									has_opinion = {
										target = PREV
										value < 0
									}
								}
							}
						}
						add = 5
					}
					modifier = {
						any_neighbor_country = {
							has_country_flag = target_of_league_of_nations_voting
							NOT = {
								OR = {
									has_war_with = ROOT
									NOT = { check_variable = { league_of_nations_generated_threat < 20 } }
									ROOT = {
										has_opinion = {
											target = PREV
											value < 0
										}
									}
								}
							}
						}
						add = 5
					}
					modifier = {
						NOT = { has_global_flag = GER_anschluss_voting }
						NOT = { has_global_flag = ITA_ETH_voting }
						NOT = { has_global_flag = SOV_FIN_voting }
						any_country = {
							has_country_flag = target_of_league_of_nations_voting
							NOT = { is_neighbor_of = ROOT }
							NOT = {
								OR = {
									has_war_with = ROOT
									NOT = { check_variable = { league_of_nations_generated_threat < 20 } }
									ROOT = {
										has_opinion = {
											target = PREV
											value < 0
										}
									}
								}
							}
						}
						add = 15
					}
					modifier = {
						has_global_flag = GER_anschluss_voting
						add = 5
					}
					modifier = {
						any_neighbor_country = {
							has_country_flag = target_of_league_of_nations_voting
							check_variable = { num_of_active_league_of_nations_trade_sanctions > 0 }
						}
						add = 2
					}
					modifier = {
						any_country = {
							has_country_flag = target_of_league_of_nations_voting
							check_variable = { num_of_active_league_of_nations_trade_sanctions > 1 }
						}
						add = 2
					}
					modifier = {
						any_country = {
							has_country_flag = target_of_league_of_nations_voting
							check_variable = { num_of_active_league_of_nations_trade_sanctions > 2 }
						}
						add = 2
					}
					modifier = {
						any_country = {
							has_country_flag = target_of_league_of_nations_voting
							check_variable = { num_of_active_league_of_nations_trade_sanctions > 3 }
						}
						add = 3
					}
					modifier = {
						any_country = {
							has_country_flag = target_of_league_of_nations_voting
							check_variable = { num_of_active_league_of_nations_trade_sanctions > 4 }
						}
						add = 3
					}
					modifier = {
						any_country = {
							has_country_flag = target_of_league_of_nations_voting
							check_variable = { num_of_active_league_of_nations_trade_sanctions > 5 }
						}
						add = 5
					}
					modifier = {
						any_country = {
							has_country_flag = target_of_league_of_nations_voting
							check_variable = { num_of_active_league_of_nations_trade_sanctions > 6 }
						}
						add = 5
					}
					modifier = {
						any_country = {
							has_country_flag = target_of_league_of_nations_voting
							check_variable = { num_of_active_league_of_nations_trade_sanctions > 7 }
						}
						add = 5
					}
					modifier = {
						any_country = {
							has_country_flag = target_of_league_of_nations_voting
							check_variable = { num_of_active_league_of_nations_trade_sanctions > 8 }
						}
						add = 5
					}
					modifier = {
						is_subject = yes
						any_country = {
							has_country_flag = target_of_league_of_nations_voting
							ROOT = { is_subject_of = PREV }
						}
						add = 1000
					}
					modifier = {
						any_country = {
							has_country_flag = target_of_league_of_nations_voting
							has_capitulated = yes
						}
						add = 10
					}
					modifier = {
						any_country = {
							has_country_flag = target_of_league_of_nations_voting
							has_government = ROOT
						}
						add = 10
					}
					modifier = {
						any_country = {
							has_country_flag = target_of_league_of_nations_voting
							is_in_faction_with = ROOT
						}
						add = 100
					}
					modifier = {
						any_country = {
							has_country_flag = target_of_league_of_nations_voting
							NOT = { has_war_with = ROOT }
						}
						NOT = {
							any_neighbor_country = {
								OR = {
									has_country_flag = target_of_league_of_nations_voting
									any_neighbor_country = {
										OR = {
											has_country_flag = target_of_league_of_nations_voting
											any_neighbor_country = {
												OR = {
													has_country_flag = target_of_league_of_nations_voting
													any_neighbor_country = {
														has_country_flag = target_of_league_of_nations_voting
													}
												}
											}
										}
									}
								}
							}
						}
						add = 20
					}
					modifier = {
						has_global_flag = league_of_nations_always_vote_no_cheat_flag
						add = 10000
					}
				}
			}
			league_of_nations_close_button_click = {
				ai_will_do = {
					factor = 0
				}
			}
			league_of_nations_leave_button_click = {
				ai_will_do = {
					factor = 0

					modifier = {
						AI_wants_to_leave_league_of_nations = yes
						add = 100
					}
				}
			}
			league_of_nations_noconfidence_vote_button_click = {
				ai_will_do = {
					factor = 0

					modifier = {
						check_variable = { global.days_til_next_league_of_nations_election > 70 }
						check_variable = { global.days_til_next_league_of_nations_election < 320 }
						any_country = {
							has_country_flag = leader_of_league_of_nations
							OR = {
								AND = {
									OR = {
										has_government = fascism
										has_government = communism
									}
									ROOT = {
										NOT = { has_government = fascism }
										NOT = { has_government = communism }
									}
								}
								AND = {
									ROOT = {
										OR = {
											has_government = fascism
											has_government = communism
										}
									}
									NOT = { has_government = fascism }
									NOT = { has_government = communism }
								}
								ROOT = {
									has_opinion = {
										target = PREV
										value < -30
									}
								}
								AND = {
									ROOT = { has_government = democratic }
									check_variable = { league_of_nations_generated_threat > 30 }
									any_country = {
										has_country_flag = member_of_league_of_nations
										ROOT = {
											has_opinion = {
												target = PREV
												value > 0
											}
											check_variable = { league_of_nations_generated_threat < 30 }
										}
									}
								}
								AND = {
									check_variable = { league_of_nations_generated_threat > 60 }
									any_country = {
										has_country_flag = member_of_league_of_nations
										ROOT = {
											has_opinion = {
												target = PREV
												value > 0
											}
											check_variable = { league_of_nations_generated_threat < 60 }
										}
									}
								}
							}
						}
						add = 1000
					}
				}
			}
			league_of_nations_noconfidence_vote_button_selected_click = {
				ai_will_do = {
					factor = 0

					modifier = {
						any_country = {
							has_country_flag = leader_of_league_of_nations
							NOT = {
								OR = {
									AND = {
										OR = {
											has_government = fascism
											has_government = communism
										}
										ROOT = {
											NOT = { has_government = fascism }
											NOT = { has_government = communism }
										}
									}
									AND = {
										ROOT = {
											OR = {
												has_government = fascism
												has_government = communism
											}
										}
										NOT = { has_government = fascism }
										NOT = { has_government = communism }
									}
									ROOT = {
										has_opinion = {
											target = PREV
											value < -30
										}
									}
									AND = {
										ROOT = { has_government = democratic }
										check_variable = { league_of_nations_generated_threat > 30 }
										any_country = {
											has_country_flag = member_of_league_of_nations
											ROOT = {
												has_opinion = {
													target = PREV
													value > 0
												}
												check_variable = { league_of_nations_generated_threat < 30 }
											}
										}
									}
									AND = {
										check_variable = { league_of_nations_generated_threat > 60 }
										any_country = {
											has_country_flag = member_of_league_of_nations
											ROOT = {
												has_opinion = {
													target = PREV
													value > 0
												}
												check_variable = { league_of_nations_generated_threat < 60 }
											}
										}
									}
								}
							}
						}
						add = 1000
					}
				}
			}
		}
	}

	league_of_nations_sanctions_types_window = {
		context_type = player_context

		window_name = "league_of_nations_sanctions_types_window"
		parent_window_name = "league_of_nations_window"

		visible = {
			OR = {
				is_ai = yes
				check_variable = { show_league_of_nations > 0 }
			}
			has_country_flag = league_of_nations_voted_yes
		}

		effects = {
			league_of_nations_vote_sanction_type_trade_sanctions_click = {
				set_country_flag = league_of_nations_voted_sanction_type_trade
				add_to_variable = { global.num_of_trade_sanction_votes_in_league_of_nations_voting = 1 }
			}
			league_of_nations_vote_sanction_type_war_click = {
				set_country_flag = league_of_nations_voted_sanction_type_war
				add_to_variable = { global.num_of_war_votes_in_league_of_nations_voting = 1 }
			}
			league_of_nations_vote_sanction_type_kick_out_of_league_of_nations_click = {
				set_country_flag = league_of_nations_voted_sanction_type_kick_out_of_league_of_nations
				add_to_variable = { global.num_of_kick_out_of_league_of_nations_votes_in_league_of_nations_voting = 1 }
			}
			league_of_nations_vote_sanction_type_form_coalition_click = {
				set_country_flag = league_of_nations_voted_sanction_type_form_coalition
				add_to_variable = { global.num_of_form_coalition_votes_in_league_of_nations_voting = 1 }
			}
		}

		triggers = {
			league_of_nations_vote_sanction_type_trade_sanctions_click_enabled = {
				check_variable = { global.league_of_nations_voting_time > 0 }
				NOT = { has_country_flag = league_of_nations_voted_sanction_type_trade }
				NOT = { has_country_flag = league_of_nations_voted_sanction_type_war }
				NOT = { has_country_flag = league_of_nations_voted_sanction_type_kick_out_of_league_of_nations }
				NOT = { has_country_flag = league_of_nations_voted_sanction_type_form_coalition }
				has_country_flag = member_of_league_of_nations
			}
			league_of_nations_vote_sanction_type_war_click_enabled = {
				check_variable = { global.league_of_nations_voting_time > 0 }
				NOT = { has_country_flag = league_of_nations_voted_sanction_type_trade }
				NOT = { has_country_flag = league_of_nations_voted_sanction_type_war }
				NOT = { has_country_flag = league_of_nations_voted_sanction_type_kick_out_of_league_of_nations }
				NOT = { has_country_flag = league_of_nations_voted_sanction_type_form_coalition }
				has_country_flag = member_of_league_of_nations
			}
			league_of_nations_vote_sanction_type_kick_out_of_league_of_nations_click_enabled = {
				check_variable = { global.league_of_nations_voting_time > 0 }
				NOT = { has_country_flag = league_of_nations_voted_sanction_type_trade }
				NOT = { has_country_flag = league_of_nations_voted_sanction_type_war }
				NOT = { has_country_flag = league_of_nations_voted_sanction_type_kick_out_of_league_of_nations }
				NOT = { has_country_flag = league_of_nations_voted_sanction_type_form_coalition }
				has_country_flag = member_of_league_of_nations
			}
			league_of_nations_vote_sanction_type_form_coalition_click_enabled = {
				check_variable = { global.league_of_nations_voting_time > 0 }
				NOT = { has_country_flag = league_of_nations_voted_sanction_type_trade }
				NOT = { has_country_flag = league_of_nations_voted_sanction_type_war }
				NOT = { has_country_flag = league_of_nations_voted_sanction_type_kick_out_of_league_of_nations }
				NOT = { has_country_flag = league_of_nations_voted_sanction_type_form_coalition }
				has_country_flag = member_of_league_of_nations
				has_global_flag = league_of_nations_focus_2_completed
			}
			league_of_nations_vote_sanction_type_kick_out_of_league_of_nations_visible = {
				any_country = {
					has_country_flag = target_of_league_of_nations_voting
					has_country_flag = member_of_league_of_nations
				}
			}
			league_of_nations_vote_sanction_type_kick_out_of_league_of_nations_text_visible = {
				any_country = {
					has_country_flag = target_of_league_of_nations_voting
					has_country_flag = member_of_league_of_nations
				}
			}
			league_of_nations_vote_sanction_type_form_coalition_visible = {
				any_country = {
					has_country_flag = target_of_league_of_nations_voting
					NOT = { has_country_flag = member_of_league_of_nations }
					NOT = { check_variable = { league_of_nations_generated_threat < 50 } }
					NOT = { has_idea = league_of_nations_defense_pact_target }
				}
			}
			league_of_nations_vote_sanction_type_form_coalition_text_visible = {
				any_country = {
					has_country_flag = target_of_league_of_nations_voting
					NOT = { has_country_flag = member_of_league_of_nations }
					NOT = { check_variable = { league_of_nations_generated_threat < 50 } }
					NOT = { has_idea = league_of_nations_defense_pact_target }
				}
			}
			league_of_nations_vote_sanction_type_trade_sanctions_glow_visible = {
				has_global_flag = league_of_nations_voting
				has_country_flag = league_of_nations_voted_sanction_type_trade
			}
			league_of_nations_vote_sanction_type_war_glow_visible = {
				has_global_flag = league_of_nations_voting
				has_country_flag = league_of_nations_voted_sanction_type_war
			}
			league_of_nations_vote_sanction_type_kick_out_of_league_of_nations_glow_visible = {
				has_global_flag = league_of_nations_voting
				OR = {
					has_country_flag = league_of_nations_voted_sanction_type_kick_out_of_league_of_nations
					has_country_flag = league_of_nations_voted_sanction_type_form_coalition
				}
			}
		}

		ai_enabled = {
			always = yes
		}

		ai_test_interval = 24
		ai_test_variance = 0.2

		ai_check = {
			has_global_flag = league_of_nations_voting
			NOT = { has_country_flag = league_of_nations_voted_sanction_type_trade }
			NOT = { has_country_flag = league_of_nations_voted_sanction_type_war }
			NOT = { has_country_flag = league_of_nations_voted_sanction_type_kick_out_of_league_of_nations }
			NOT = { has_country_flag = league_of_nations_voted_sanction_type_form_coalition }
		}

		ai_weights = {
			league_of_nations_vote_sanction_type_trade_sanctions_click = {
				ai_will_do = {
					factor = 0

					modifier = {
						any_country = {
							has_country_flag = target_of_league_of_nations_voting
							OR = {
								AND = {
									NOT = { has_country_flag = member_of_league_of_nations }
									NOT = { has_global_flag = SOV_FIN_voting }
								}
								has_global_flag = ITA_ETH_voting
								check_variable = { league_of_nations_generated_threat < 25 }
							}
							OR = {
								ROOT = {
									NOT = { has_government = fascism }
									NOT = { has_government = communism }
								}
								is_in_faction_with = ROOT
							}
						}
						add = 15
					}

					modifier = {
						any_country = {
							has_country_flag = target_of_league_of_nations_voting
						}
						any_other_country = {
							is_justifying_wargoal_against = LON
						}
						add = 50
					}
				}
			}
			league_of_nations_vote_sanction_type_war_click = {
				ai_will_do = {
					factor = 0

					modifier = {
						any_country = {
							has_country_flag = target_of_league_of_nations_voting
							NOT = { is_in_faction_with = ROOT }
						}
						OR = {
							has_government = fascism
							has_government = communism
						}
						add = 5
					}

					modifier = {
						any_other_country = {
							is_justifying_wargoal_against = LON
						}
						OR = {
							has_government = fascism
							has_government = communism
						}
						add = 10
					}
				}
			}
			league_of_nations_vote_sanction_type_kick_out_of_league_of_nations_click = {
				ai_will_do = {
					factor = 0

					modifier = {
						NOT = { has_global_flag = ITA_ETH_voting }
						any_country = {
							has_country_flag = target_of_league_of_nations_voting
							has_country_flag = member_of_league_of_nations
							OR = {
								AND = {
									is_historical_focus_on = yes
									tag = SOV
									has_war_with = FIN
								}
								NOT = { check_variable = { league_of_nations_generated_threat < 25 } }
								has_global_flag = SOV_FIN_voting
							}
							OR = {
								ROOT = {
									NOT = { has_government = fascism }
									NOT = { has_government = communism }
								}
								is_in_faction_with = ROOT
							}
						}
						add = 10
					}

					modifier = {
						any_other_country = {
							is_justifying_wargoal_against = LON
						}
						add = 50
					}
				}
			}

			league_of_nations_vote_sanction_type_form_coalition_click = {
				ai_will_do = {
					factor = 0

					modifier = {
						any_neighbor_country = {
							has_country_flag = target_of_league_of_nations_voting
							NOT = { is_in_faction_with = ROOT }
							NOT = { check_variable = { league_of_nations_generated_threat < 50 } }
						}
						add = 100
					}
					modifier = {
						any_neighbor_country = {
							any_neighbor_country = {
								has_country_flag = target_of_league_of_nations_voting
								NOT = { is_in_faction_with = ROOT }
								NOT = { check_variable = { league_of_nations_generated_threat < 50 } }
							}
						}
						add = 10
					}
				}
			}
		}
	}

	league_of_nations_start_voting_country_list_window = {
		context_type = player_context

		window_name = "league_of_nations_start_voting_country_list_window"
		parent_window_name = "league_of_nations_window"

		visible = {
			ROOT = {
				is_ai = no
				check_variable = { show_league_of_nations_start_voting_country_list > 0 }
				# checks for it being allowed to open this window:
				has_country_flag = member_of_league_of_nations
				check_variable = { global.time_til_next_possible_league_of_nations_voting < 1 }
				NOT = { has_global_flag = league_of_nations_election }
				NOT = { has_global_flag = GER_anschluss_voting_in_queue }
				NOT = { has_global_flag = SOV_FIN_voting_triggered }
				NOT = { has_global_flag = league_of_nations_voting }
				OR = {
					check_variable = { global.days_til_next_league_of_nations_election > 70 }
					has_global_flag = league_of_nations_focus_6_completed
				}
				any_other_country = {
					NOT = { has_country_flag = leader_of_league_of_nations }
					check_variable = { num_of_active_league_of_nations_trade_sanctions < 10 }
					check_variable = { cooldown_for_league_of_nations_voting < 1 }
					NOT = { check_variable = { league_of_nations_generated_threat < 10 } }
				}
			}
		}

		effects = {
			league_of_nations_start_voting_country_list_window_close_button_click = {
				set_variable = { show_league_of_nations_start_voting_country_list = 0 }
				clear_array = league_of_nations_possible_voting_targets_array
			}
			# List:
			entry_bg_click = {
				country_event = { id = league_of_nations_events.2 }
				news_event = { id = league_of_nations_news_events.7 }
				ROOT = { set_country_flag = started_league_of_nations_voting }
				set_variable = { show_league_of_nations_start_voting_country_list = 0 }
				clear_array = league_of_nations_possible_voting_targets_array
			}
			entry_flag_click = {
				capital_scope = {
					ROOT = {
						goto_state = PREV
					}
				}
			}
		}

		triggers = {
			entry_bg_click_enabled = {
				NOT = { has_country_flag = leader_of_league_of_nations }
				check_variable = { num_of_active_league_of_nations_trade_sanctions < 10 }
				check_variable = { cooldown_for_league_of_nations_voting < 1 }
				NOT = { check_variable = { league_of_nations_generated_threat < 10 } }
			}
		}

		dynamic_lists = {
			league_of_nations_possible_voting_targets_list_gridbox = {
				array = league_of_nations_possible_voting_targets_array
				entry_container = league_of_nations_possible_voting_targets_list_entry
				change_scope = yes
			}
		}

		properties = {
			entry_flag = {
				image = "[This.GetFlag]"
			}
		}
	}

	start_league_of_nations_voting_window = {
		context_type = selected_country_context

		window_name = "start_league_of_nations_voting_window"
		parent_window_token = selected_country_view_diplomacy

		visible = {
			NOT = { tag = ROOT }
			ROOT = {
				has_country_flag = member_of_league_of_nations
			}
		}

		effects = {
			start_league_of_nations_voting_button_click = {
				country_event = { id = league_of_nations_events.2 }
				news_event = { id = league_of_nations_news_events.7 }
				ROOT = { set_country_flag = started_league_of_nations_voting }
			}
		}

		triggers = {
			start_league_of_nations_voting_button_click_enabled = {
				check_variable = { global.time_til_next_possible_league_of_nations_voting < 1 }
				check_variable = { num_of_active_league_of_nations_trade_sanctions < 10 }
				NOT = { has_global_flag = GER_anschluss_voting_in_queue }
				NOT = { has_global_flag = SOV_FIN_voting_triggered }
				NOT = { has_country_flag = leader_of_league_of_nations }
				NOT = { has_global_flag = league_of_nations_voting }
				check_variable = { cooldown_for_league_of_nations_voting < 1 }
				NOT = { check_variable = { league_of_nations_generated_threat < 10 } }
				NOT = { has_global_flag = league_of_nations_election }
				OR = {
					check_variable = { global.days_til_next_league_of_nations_election > 70 }
					has_global_flag = league_of_nations_focus_6_completed
				}
			}
		}

		ai_enabled = {
			always = yes
		}

		ai_test_interval = 720
		ai_test_variance = 0.1

		ai_check = {
			is_subject = no
			NOT = { has_global_flag = league_of_nations_voting }
			any_neighbor_country = {
				NOT = { has_country_flag = leader_of_league_of_nations }
				check_variable = { cooldown_for_league_of_nations_voting < 1 }
				OR = {
					NOT = { check_variable = { league_of_nations_generated_threat < 15 } }
					AND = {
						NOT = { check_variable = { league_of_nations_generated_threat < 10 } }
						has_war_with = ROOT
					}
				}
				NOT = { has_global_flag = league_of_nations_election }
				OR = {
					check_variable = { global.days_til_next_league_of_nations_election > 70 }
					has_global_flag = league_of_nations_focus_6_completed
				}
				NOT = { is_in_faction_with = ROOT }
				NOT = { has_government = ROOT }
				NOT = { check_variable = { num_of_failed_league_of_nations_votings_against_us > 2 } }
			}
		}

		ai_test_scopes = test_neighbouring_countries

		ai_check_scope = {
			NOT = { has_country_flag = leader_of_league_of_nations }
			check_variable = { cooldown_for_league_of_nations_voting < 1 }
			OR = {
				NOT = { check_variable = { league_of_nations_generated_threat < 15 } }
				AND = {
					NOT = { check_variable = { league_of_nations_generated_threat < 10 } }
					has_war_with = ROOT
				}
			}
			NOT = { is_in_faction_with = ROOT }
			NOT = { has_government = ROOT }
			NOT = { check_variable = { num_of_failed_league_of_nations_votings_against_us > 2 } }
		}

		ai_weights = {
			start_league_of_nations_voting_button_click = {
				ai_will_do = {
					factor = 1
				}
			}
		}
	}

	league_of_nations_new_voting_alert_window = {
		context_type = player_context

		window_name = "league_of_nations_new_voting_alert_window"

		visible = {
			is_ai = no
			has_global_flag = league_of_nations_voting
			has_country_flag = member_of_league_of_nations
			NOT = { has_country_flag = started_league_of_nations_voting }
			NOT = { has_country_flag = target_of_league_of_nations_voting }
			NOT = { has_country_flag = league_of_nations_voted_yes }
			NOT = { has_country_flag = league_of_nations_voted_no }
			check_variable = { show_league_of_nations_new_voting_alert > 0 }
		}

		effects = {
			league_of_nations_alert_close_button_click = {
				set_variable = { show_league_of_nations_new_voting_alert = 0 }
			}
			league_of_nations_alert_goto_button_click = {
				set_variable = { show_league_of_nations_new_voting_alert = 0 }
				set_variable = { show_league_of_nations = 1 }
			}
		}
	}

	league_of_nations_trade_view_alert_window = {
		context_type = player_context

		window_name = "league_of_nations_trade_view_alert_window"
		parent_window_token = trade_tab

		visible = {
			is_ai = no
			check_variable = { num_of_active_league_of_nations_trade_sanctions > 0 }
		}
	}

	league_of_nations_map_mode_legend_window = {
		context_type = player_context

		window_name = "league_of_nations_map_mode_legend_window"

		visible = {
			is_ai = no
			has_global_flag = league_of_nations_map_mode_active
		}

		effects = {
			legend_icon_league_of_nations_leader_click = {
				random_country = {
					limit = {
						has_country_flag = leader_of_league_of_nations
					}
					capital_scope = {
						ROOT = { goto_state = PREV }
					}
				}
			}
			legend_icon_league_of_nations_starter_of_voting_click = {
				random_country = {
					limit = {
						has_country_flag = started_league_of_nations_voting
					}
					capital_scope = {
						ROOT = { goto_state = PREV }
					}
				}
			}
			legend_icon_league_of_nations_target_of_voting_click = {
				random_country = {
					limit = {
						has_country_flag = target_of_league_of_nations_voting
					}
					capital_scope = {
						ROOT = { goto_state = PREV }
					}
				}
			}
			legend_icon_league_of_nations_target_member_of_voting_click = {
				random_country = {
					limit = {
						has_country_flag = target_of_league_of_nations_voting
					}
					capital_scope = {
						ROOT = { goto_state = PREV }
					}
				}
			}
			leave_league_of_nations_map_mode_button_click = {
				every_country = {
					remove_league_of_nations_map_mode_tags = yes
				}
				clr_global_flag = league_of_nations_map_mode_active
				set_variable = { dont_show_league_of_nations_map_mode_legend = 0 }
				set_variable = { y_position_of_leave_league_of_nations_map_mode_button = 200 }
			}
			collapse_league_of_nations_map_mode_button_click = {
				set_variable = { dont_show_league_of_nations_map_mode_legend = 1 }
				set_variable = { y_position_of_leave_league_of_nations_map_mode_button = 45 }
			}
			expand_league_of_nations_map_mode_button_click = {
				set_variable = { dont_show_league_of_nations_map_mode_legend = 0 }
				set_variable = { y_position_of_leave_league_of_nations_map_mode_button = 200 }
			}
		}

		triggers = {
			league_of_nations_map_mode_legend_window_background_visible = {
				check_variable = { dont_show_league_of_nations_map_mode_legend < 1 }
			}
			collapse_league_of_nations_map_mode_button_visible = {
				check_variable = { dont_show_league_of_nations_map_mode_legend < 1 }
			}
			expand_league_of_nations_map_mode_button_visible = {
				check_variable = { dont_show_league_of_nations_map_mode_legend > 0 }
			}
			legend_icon_league_of_nations_leader_visible = {
				check_variable = { dont_show_league_of_nations_map_mode_legend < 1 }
			}
			league_of_nations_leader_legend_title_visible = {
				check_variable = { dont_show_league_of_nations_map_mode_legend < 1 }
			}
			legend_icon_league_of_nations_member_visible = {
				check_variable = { dont_show_league_of_nations_map_mode_legend < 1 }
			}
			league_of_nations_member_legend_title_visible = {
				check_variable = { dont_show_league_of_nations_map_mode_legend < 1 }
			}
			legend_icon_league_of_nations_non_member_visible = {
				check_variable = { dont_show_league_of_nations_map_mode_legend < 1 }
			}
			league_of_nations_non_member_legend_title_visible = {
				check_variable = { dont_show_league_of_nations_map_mode_legend < 1 }
			}
			legend_icon_league_of_nations_starter_of_voting_visible = {
				check_variable = { dont_show_league_of_nations_map_mode_legend < 1 }
			}
			league_of_nations_starter_of_voting_legend_title_visible = {
				check_variable = { dont_show_league_of_nations_map_mode_legend < 1 }
			}
			legend_icon_league_of_nations_target_of_voting_visible = {
				check_variable = { dont_show_league_of_nations_map_mode_legend < 1 }
			}
			league_of_nations_target_of_voting_slash_visible = {
				check_variable = { dont_show_league_of_nations_map_mode_legend < 1 }
			}
			legend_icon_league_of_nations_target_member_of_voting_visible = {
				check_variable = { dont_show_league_of_nations_map_mode_legend < 1 }
			}
			league_of_nations_target_of_voting_legend_title_visible = {
				check_variable = { dont_show_league_of_nations_map_mode_legend < 1 }
			}
		}

		properties = {
			leave_league_of_nations_map_mode_button = {
				y = y_position_of_leave_league_of_nations_map_mode_button
			}
		}
	}
}
