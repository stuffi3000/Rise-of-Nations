RON_initiate_crisis = {

	custom_effect_tooltip = RON_initiate_crisis_tt

	add_to_array = {
		array = global.political_active_crisis_list
		value = var:crisis_id
	}
	add_to_array = {
		array = global.crisis_originators 
		value = var:originator
	}
	add_to_array = {
		array = global.crisis_receivers
		value = var:defender
	}
	add_to_array = {
		array = global.political_crisis_list_array
		value = var:crisis_id
	}
	set_temp_variable = { num_crisis = global.political_crisis_list_array^num }
	subtract_from_temp_variable = { num_crisis = 1}
	add_to_array = {
		array = global.crisis_progress
		index = num_crisis
		value = var:progress
	}
	#set_variable = {
	#	global.crisis_progress^num_crisis = var:progress
	#}
	RON_diplo_crisis_warn = yes
}
RON_end_crisis = {
	custom_effect_tooltip = RON_end_crisis_tt
	for_each_loop = {
		array = global.political_crisis_list_array

		if = {
			limit = { 
				check_variable = { global.political_crisis_list_array^i = var:crisis_id}

			}

			remove_from_array = { global.crisis_receivers = global.crisis_receivers^i}
			remove_from_array = { global.crisis_originators = global.crisis_originators^i}
			remove_from_array = { array = global.crisis_progress value = global.crisis_progress^i}
			remove_from_array =  { global.political_crisis_list_array = var:crisis_id}
			
		}
		#remove_from_array = { global.political_active_crisis_list = var:crisis_id}
	}
	
	#remove_from_array = {
	#	array = global.political_active_crisis_list
	#	index = 0
	#} 
	#remove_from_array = {
	#	array = global.crisis_receivers 
	#	index = 0
	#}
	#remove_from_array = {
	#	array = global.crisis_originators
	#	index = 0  
	#}
	#set_variable = {global.crisis_progress^0 = global.crisis_progress^1}
	#remove_from_array = {
	#	array = global.crisis_progress
	#	index = 0
	#}


}
RON_subtract_diplo_crisis_progress = {
	custom_effect_tooltip = RON_subtract_diplo_crisis_progress_tt
	if = {
		limit = {
			has_variable = crisis_id
		}
		for_each_loop = {
			array = global.political_active_crisis_list
		
			if = {
				limit = { 
					AND = {
						check_variable = { global.political_crisis_list_array^i = var:crisis_id}
						check_variable = { global.crisis_originators^i = var:aggressor_side }
						check_variable = { global.crisis_receivers^i = var:defender_side }
					}
				}
				subtract_from_variable = { global.crisis_progress^i = var:amount }
			}
		}

	}
	else = {
		for_each_loop = {
			array = global.political_active_crisis_list
		
			if = {
				limit = {
					AND = {
						check_variable = { global.crisis_originators^i = var:aggressor_side }
						check_variable = { global.crisis_receivers^i = var:defender_side }
					}
				} 
				subtract_from_variable = { global.crisis_progress^i = var:amount }
			}
		}
	}

}
RON_set_diplo_crisis_progress = {
	custom_effect_tooltip = RON_set_diplo_crisis_progress_tt
	if = {
		limit = {
			has_variable = crisis_id
		}
		for_each_loop = {
			array = global.political_active_crisis_list
		
			if = {
				limit = { 
					AND = {
						check_variable = { global.political_crisis_list_array^i = var:crisis_id}
						check_variable = { global.crisis_originators^i = var:aggressor_side }
						check_variable = { global.crisis_receivers^i = var:defender_side }
					}
				}
				set_variable = { global.crisis_progress^i = var:amount }
			}
		}

	}
	else = {
		for_each_loop = {
			array = global.political_active_crisis_list
		
			if = {
				limit = {
					AND = {
						check_variable = { global.crisis_originators^i = var:aggressor_side }
						check_variable = { global.crisis_receivers^i = var:defender_side }
					}
				} 
				set_variable = { global.crisis_progress^i = var:amount }
			}
		}
	}
}
RON_add_diplo_crisis_progress = {
	custom_effect_tooltip = RON_add_diplo_crisis_progress_tt
	if = {
		limit = {
			has_variable = crisis_id
		}
		for_each_loop = {
			array = global.political_active_crisis_list
		
			if = {
				limit = { 
					AND = {
						check_variable = { global.political_crisis_list_array^i = var:crisis_id}
						#check_variable = { global.crisis_originators^i = var:aggressor_side }
						#check_variable = { global.crisis_receivers^i = var:defender_side } //TODO: check if this still works
					}
				}
				add_to_variable = { global.crisis_progress^i = var:amount }
			}
		}

	}
	else = {
		for_each_loop = {
			array = global.political_active_crisis_list
		
			if = {
				limit = {
					AND = {
						check_variable = { global.crisis_originators^i = var:aggressor_side }
						check_variable = { global.crisis_receivers^i = var:defender_side }
					}
				} 
				add_to_variable = { global.crisis_progress^i = var:amount }
			}
		}
	}

}

RON_diplo_crisis_warn = {
	every_country = {
		limit = {
			is_ai =  no
		}
		set_variable = { diplocrisis_open = 1 }
		set_country_flag = diplo_crisis_warn_flag
	}
	

}
RON_reload_tree = {
	load_focus_tree = generic_focus
	mark_focus_tree_layout_dirty = yes
}
predection_house = {
	set_variable = { phalfgop = republican_vote }
set_variable = { phalfdem = democratic_vote } 
divide_variable = {phalfgop = 2}
divide_variable = {phalfdem = 2}
set_variable = { pstates_remaining_house = 435  }
subtract_from_variable = { pstates_remaining_house = phalfgop  }
subtract_from_variable = { pstates_remaining_house = phalfdem  }
round_variable = pstates_remaining_house
# predection_senate too 

	add_to_variable = { rsenators_support = republican_vote }
	divide_variable = {rsenators_support = 5}
	round_variable = rsenators_support
	clamp_variable = { var = rsenators_support max = senators_total min = 0 }

}
USA_senate_election = {
	if = {
		limit = {
			has_country_flag = gop_pres
		}
	set_variable = { senators_support = republican_vote }
	divide_variable = {senators_support = 5}
	round_variable = senators_support
	clamp_variable = { var = senators_support max = senators_total min = 0 }
	USA_recalc_congress_icon_frames = yes	
	}
	if = {
		limit = {
			has_country_flag = dem_pres
		}
	set_variable = { senators_support = democratic_vote }
	divide_variable = {senators_support = 5}
	round_variable = senators_support
	clamp_variable = { var = senators_support max = senators_total min = 0 }
	USA_recalc_congress_icon_frames = yes			
	}
	
}
RON_handle_era_flags = {
	if = {
		limit = {
			has_start_date < 1910.1.1
		}
		add_ideas = RON_DNC
	}

	if = {
		limit = {
			has_start_date > 1909.12.31
			has_start_date < 1919.1.1
		}
		add_ideas = RON_WW1
	}

	#I think this is used in Endsieg Events
	if = {
		limit = {
			date < 1919.1.1
		}
		set_global_flag = welcome_event_WW1
	}

	if = {
		limit = {
			has_start_date > 1918.12.31
			has_start_date < 1933.1.1
		}
		add_ideas = RON_Interwar
	}

	if = {
		limit = {
			has_start_date > 1932.12.31
			has_start_date < 1949.1.1
		}
		add_ideas = RON_WW2
	}

	if = {
		limit = {
			has_start_date > 1948.12.31
			has_start_date < 1980.1.1
		}
		add_ideas = RON_Cold_War
	}

	if = {
		limit = {
			has_start_date > 1979.12.31
			has_start_date < 2000.1.1
		}
		add_ideas = RON_Late_Cold_War
	}

	if = {
		limit = {
			has_start_date > 1999.12.31
		}
		add_ideas = RON_Modern_Day
	}
}

RON_handle_era_generals = {
	if = {
		limit = {
			has_start_date > 1932.12.31
			has_start_date < 1949.1.1
			RON_has_custom_generals_ww2 = yes
		}
		RON_handle_ww2_generals = yes
	}

	if = {
		limit = {
			has_start_date > 1948.12.31
			has_start_date < 2000.1.1
			RON_has_custom_generals_cw = yes
		}
		RON_handle_cw_generals = yes
	}

	if = {
		limit = {
			has_start_date > 1999.12.31
			RON_has_custom_generals_md = yes
		}
		RON_handle_md_generals = yes
	}
}


RON_power_status_immediate_effects = {
	#Army

	if = { limit = { num_of_factories < 11 NOT = { has_country_flag = superstate_size1 } } set_country_flag = superstate_size1 clr_country_flag = superstate_size2 clr_country_flag = superstate_size6 clr_country_flag = superstate_size3 clr_country_flag = superstate_size4 clr_country_flag = superstate_size5 clr_country_flag = superstate_size7 }

	if = { limit = { num_of_factories < 50 num_of_factories > 10 NOT = { has_country_flag = superstate_size2 } } set_country_flag = superstate_size2 clr_country_flag = superstate_size1 clr_country_flag = superstate_size6 clr_country_flag = superstate_size3 clr_country_flag = superstate_size4 clr_country_flag = superstate_size5 clr_country_flag = superstate_size7 }

	if = { limit = { num_of_factories < 100 num_of_factories > 49 NOT = { has_country_flag = superstate_size3 } } set_country_flag = superstate_size3 clr_country_flag = superstate_size1 clr_country_flag = superstate_size6 clr_country_flag = superstate_size2 clr_country_flag = superstate_size4 clr_country_flag = superstate_size5 clr_country_flag = superstate_size7 }

	if = { limit = { num_of_factories < 500 num_of_factories > 99 NOT = { has_country_flag = superstate_size4 } } set_country_flag = superstate_size4 clr_country_flag = superstate_size1 clr_country_flag = superstate_size6 clr_country_flag = superstate_size2 clr_country_flag = superstate_size3 clr_country_flag = superstate_size5 clr_country_flag = superstate_size7 }

	if = { limit = { num_of_factories < 1000 num_of_factories > 499 NOT = { has_country_flag = superstate_size5 } } set_country_flag = superstate_size5 clr_country_flag = superstate_size1 clr_country_flag = superstate_size6 clr_country_flag = superstate_size2 clr_country_flag = superstate_size3 clr_country_flag = superstate_size4 clr_country_flag = superstate_size7 }

	if = { limit = { num_of_factories > 999 num_of_factories < 1500 NOT = { has_country_flag = superstate_size6 } } set_country_flag = superstate_size6 clr_country_flag = superstate_size1 clr_country_flag = superstate_size5 clr_country_flag = superstate_size2 clr_country_flag = superstate_size3 clr_country_flag = superstate_size4 clr_country_flag = superstate_size7 }

	if = { limit = { num_of_factories > 1499 NOT = { has_country_flag = superstate_size7 } } set_country_flag = superstate_size7 clr_country_flag = superstate_size1 clr_country_flag = superstate_size6 clr_country_flag = superstate_size5 clr_country_flag = superstate_size2 clr_country_flag = superstate_size3 clr_country_flag = superstate_size4 }

	if = { limit = { num_divisions < 1 NOT = { has_country_flag = army_size1 } } set_country_flag = army_size1 clr_country_flag = army_size6 clr_country_flag = army_size3 clr_country_flag = army_size4 clr_country_flag = army_size5 clr_country_flag = army_size7 clr_country_flag = army_size2 clr_country_flag = army_size8 }

	if = { limit = { num_divisions > 0 num_divisions < 10 NOT = { has_country_flag = army_size2 } } set_country_flag = army_size2 clr_country_flag = army_size6 clr_country_flag = army_size3 clr_country_flag = army_size4 clr_country_flag = army_size5 clr_country_flag = army_size7 clr_country_flag = army_size1 clr_country_flag = army_size8 }

	if = { limit = { num_divisions < 50 num_divisions > 10 NOT = { has_country_flag = army_size3 } } set_country_flag = army_size3 clr_country_flag = army_size6 clr_country_flag = army_size2 clr_country_flag = army_size4 clr_country_flag = army_size5 clr_country_flag = army_size7 clr_country_flag = army_size1 clr_country_flag = army_size8 }

	if = { limit = { num_divisions < 100 num_divisions > 50 NOT = { has_country_flag = army_size4 } } set_country_flag = army_size4 clr_country_flag = army_size6 clr_country_flag = army_size2 clr_country_flag = army_size3 clr_country_flag = army_size5 clr_country_flag = army_size7 clr_country_flag = army_size1 clr_country_flag = army_size8 }

	if = { limit = { num_divisions < 200 num_divisions > 100 NOT = { has_country_flag = army_size5 } } set_country_flag = army_size5 clr_country_flag = army_size6 clr_country_flag = army_size2 clr_country_flag = army_size3 clr_country_flag = army_size4 clr_country_flag = army_size7 clr_country_flag = army_size1 clr_country_flag = army_size8 }

	if = { limit = { num_divisions < 500 num_divisions > 200 NOT = { has_country_flag = army_size6 } } set_country_flag = army_size6 clr_country_flag = army_size5 clr_country_flag = army_size2 clr_country_flag = army_size3 clr_country_flag = army_size4 clr_country_flag = army_size7 clr_country_flag = army_size1 clr_country_flag = army_size8 }

	if = { limit = { num_divisions < 610 num_divisions > 500 NOT = { has_country_flag = army_size7 } } set_country_flag = army_size7 clr_country_flag = army_size5 clr_country_flag = army_size2 clr_country_flag = army_size3 clr_country_flag = army_size4 clr_country_flag = army_size6 clr_country_flag = army_size1 clr_country_flag = army_size8 }

	if = { limit = { num_divisions > 610 NOT = { has_country_flag = army_size8 } } set_country_flag = army_size8 clr_country_flag = army_size5 clr_country_flag = army_size2 clr_country_flag = army_size3 clr_country_flag = army_size4 clr_country_flag = army_size6 clr_country_flag = army_size1 clr_country_flag = army_size7 }

	#Airforce

	if = { limit = { RON_Airforce_Size1 = yes NOT = { has_country_flag = airforce_size1 } } set_country_flag = airforce_size1 clr_country_flag = airforce_size6    clr_country_flag = airforce_size3 clr_country_flag = airforce_size4 clr_country_flag = airforce_size5 clr_country_flag = airforce_size2 clr_country_flag = airforce_size7 clr_country_flag = airforce_size8 }

	if = { limit = { RON_Airforce_Size2 = yes NOT = { has_country_flag = airforce_size2 } } set_country_flag = airforce_size2 clr_country_flag = airforce_size6    clr_country_flag = airforce_size3 clr_country_flag = airforce_size4 clr_country_flag = airforce_size5 clr_country_flag = airforce_size1 clr_country_flag = airforce_size7 clr_country_flag = airforce_size8 }

	if = { limit = { RON_Airforce_Size3 = yes NOT = { has_country_flag = airforce_size3 } } set_country_flag = airforce_size3 clr_country_flag = airforce_size6    clr_country_flag = airforce_size2 clr_country_flag = airforce_size4 clr_country_flag = airforce_size5 clr_country_flag = airforce_size5 clr_country_flag = airforce_size1 clr_country_flag = airforce_size7 clr_country_flag = airforce_size8 }

	if = { limit = { RON_Airforce_Size4 = yes NOT = { has_country_flag = airforce_size4 } } set_country_flag = airforce_size4 clr_country_flag = airforce_size6 clr_country_flag = airforce_size3    clr_country_flag = airforce_size2 clr_country_flag = airforce_size5 clr_country_flag = airforce_size5 clr_country_flag = airforce_size1 clr_country_flag = airforce_size7 clr_country_flag = airforce_size8 }

	if = { limit = { RON_Airforce_Size5 = yes NOT = { has_country_flag = airforce_size5 } } set_country_flag = airforce_size5 clr_country_flag = airforce_size6 clr_country_flag = airforce_size3    clr_country_flag = airforce_size4 clr_country_flag = airforce_size2 clr_country_flag = airforce_size5 clr_country_flag = airforce_size1 clr_country_flag = airforce_size7 clr_country_flag = airforce_size8 }

	if = { limit = { RON_Airforce_Size6 = yes NOT = { has_country_flag = airforce_size6 } } set_country_flag = airforce_size6 clr_country_flag = airforce_size2 clr_country_flag = airforce_size3    clr_country_flag = airforce_size4 clr_country_flag = airforce_size5 clr_country_flag = airforce_size5 clr_country_flag = airforce_size1 clr_country_flag = airforce_size7 clr_country_flag = airforce_size8 }

	if = { limit = { RON_Airforce_Size7 = yes NOT = { has_country_flag = airforce_size7 } } set_country_flag = airforce_size7 clr_country_flag = airforce_size2 clr_country_flag = airforce_size3    clr_country_flag = airforce_size4 clr_country_flag = airforce_size5 clr_country_flag = airforce_size5 clr_country_flag = airforce_size1 clr_country_flag = airforce_size6 clr_country_flag = airforce_size8 }

	if = { limit = { RON_Airforce_Size8 = yes   NOT = { has_country_flag = airforce_size8 } } set_country_flag = airforce_size8 clr_country_flag = airforce_size2 clr_country_flag = airforce_size3    clr_country_flag = airforce_size4 clr_country_flag = airforce_size5 clr_country_flag = airforce_size5 clr_country_flag = airforce_size1 clr_country_flag = airforce_size6 clr_country_flag = airforce_size7 }

	#Naval

	if = { limit = { has_navy_size = { size < 1 } NOT = { has_country_flag = navy_size1 } } set_country_flag = navy_size1 clr_country_flag = navy_size6 clr_country_flag = navy_size3 clr_country_flag = navy_size4 clr_country_flag = navy_size5 clr_country_flag = navy_size2 clr_country_flag = navy_size7 clr_country_flag = navy_size8 }

	if = { limit = { has_navy_size = { size > 0 } has_navy_size = { size < 20 } NOT = { has_country_flag = navy_size2 } } set_country_flag = navy_size2 clr_country_flag = navy_size6 clr_country_flag = navy_size3 clr_country_flag = navy_size4 clr_country_flag = navy_size5 clr_country_flag = navy_size1 clr_country_flag = navy_size7 clr_country_flag = navy_size8 }

	if = { limit = { has_navy_size = { size < 50 } has_navy_size = { size > 20 } NOT = { has_country_flag = navy_size3 } } set_country_flag = navy_size3 clr_country_flag = navy_size6 clr_country_flag = navy_size2 clr_country_flag = navy_size4 clr_country_flag = navy_size5 clr_country_flag = navy_size1 clr_country_flag = navy_size7 clr_country_flag = navy_size8 }

	if = { limit = { has_navy_size = { size < 110 } has_navy_size = { size > 50 } NOT = { has_country_flag = navy_size4 } } set_country_flag = navy_size4 clr_country_flag = navy_size6    clr_country_flag = navy_size3 clr_country_flag = navy_size2 clr_country_flag = navy_size5 clr_country_flag = navy_size1 clr_country_flag = navy_size7 clr_country_flag = navy_size8 }

	if = { limit = { has_navy_size = { size < 175 } has_navy_size = { size > 110 } NOT = { has_country_flag = navy_size5 } } set_country_flag = navy_size5 clr_country_flag = navy_size6    clr_country_flag = navy_size3 clr_country_flag = navy_size4 clr_country_flag = navy_size2 clr_country_flag = navy_size1 clr_country_flag = navy_size7 clr_country_flag = navy_size8 }

	if = { limit = { has_navy_size = { size > 175 } has_navy_size = { size < 500 } NOT = { has_country_flag = navy_size6 } } set_country_flag = navy_size6 clr_country_flag = navy_size2    clr_country_flag = navy_size3 clr_country_flag = navy_size4 clr_country_flag = navy_size5 clr_country_flag = navy_size1 clr_country_flag = navy_size7 clr_country_flag = navy_size8 }

	if = { limit = { has_navy_size = { size > 500 } has_navy_size = { size < 1050 } NOT = { has_country_flag = navy_size7 } } set_country_flag = navy_size7 clr_country_flag = navy_size2    clr_country_flag = navy_size3 clr_country_flag = navy_size4 clr_country_flag = navy_size5 clr_country_flag = navy_size1 clr_country_flag = navy_size6 clr_country_flag = navy_size8 }

	if = { limit = { has_navy_size = { size > 1050 } NOT = { has_country_flag = navy_size8 } } set_country_flag = navy_size8 clr_country_flag = navy_size2    clr_country_flag = navy_size3 clr_country_flag = navy_size4 clr_country_flag = navy_size5 clr_country_flag = navy_size1 clr_country_flag = navy_size6 clr_country_flag = navy_size7 }

}

RON_power_status_ok_effects = {
	#Army

	if = { limit = { has_country_flag = superstate_size1 NOT = { has_idea = superstate_size1 } } add_ideas = superstate_size1 hidden_effect = { remove_ideas = superstate_size2 remove_ideas = superstate_size6    remove_ideas = superstate_size3 remove_ideas = superstate_size4 remove_ideas = superstate_size5 remove_ideas = superstate_size7 } }

	if = { limit = { has_country_flag = superstate_size2 NOT = { has_idea = superstate_size2 } } add_ideas = superstate_size2 hidden_effect = { remove_ideas = superstate_size1 remove_ideas = superstate_size6    remove_ideas = superstate_size3 remove_ideas = superstate_size4 remove_ideas = superstate_size5 remove_ideas = superstate_size7 } }

	if = { limit = { has_country_flag = superstate_size3 NOT = { has_idea = superstate_size3 } } add_ideas = superstate_size3 hidden_effect = { remove_ideas = superstate_size1 remove_ideas = superstate_size6 remove_ideas = superstate_size2 remove_ideas = superstate_size4 remove_ideas = superstate_size5 remove_ideas = superstate_size7 } }

	if = { limit = { has_country_flag = superstate_size4 NOT = { has_idea = superstate_size4 } } add_ideas = superstate_size4 hidden_effect = { remove_ideas = superstate_size1 remove_ideas = superstate_size6 remove_ideas = superstate_size2 remove_ideas = superstate_size3 remove_ideas = superstate_size5 remove_ideas = superstate_size7 } }

	if = { limit = { has_country_flag = superstate_size5 NOT = { has_idea = superstate_size5 } } add_ideas = superstate_size5 hidden_effect = { remove_ideas = superstate_size1 remove_ideas = superstate_size6 remove_ideas = superstate_size2 remove_ideas = superstate_size3 remove_ideas = superstate_size4 remove_ideas = superstate_size7 } }

	if = { limit = { has_country_flag = superstate_size6 NOT = { has_idea = superstate_size6 } } add_ideas = superstate_size6 hidden_effect = { remove_ideas = superstate_size1 remove_ideas = superstate_size5 remove_ideas = superstate_size2 remove_ideas = superstate_size3 remove_ideas = superstate_size4 remove_ideas = superstate_size7 } }

	if = { limit = { has_country_flag = superstate_size7 NOT = { has_idea = superstate_size7 } } add_ideas = superstate_size7 hidden_effect = { remove_ideas = superstate_size1 remove_ideas = superstate_size5 remove_ideas = superstate_size2 remove_ideas = superstate_size3 remove_ideas = superstate_size4 remove_ideas = superstate_size6 } }

	#Army
	if = { limit = { has_country_flag = army_size1 NOT = { has_idea = army_size1 } } add_ideas = army_size1 hidden_effect = { remove_ideas = army_size6    remove_ideas = army_size3 remove_ideas = army_size4 remove_ideas = army_size5 remove_ideas = army_size2 remove_ideas = army_size7 remove_ideas = army_size8 } }

	if = { limit = { has_country_flag = army_size2 NOT = { has_idea = army_size2 } } add_ideas = army_size2 hidden_effect = { remove_ideas = army_size6    remove_ideas = army_size3 remove_ideas = army_size4 remove_ideas = army_size5 remove_ideas = army_size1 remove_ideas = army_size7 remove_ideas = army_size8 } }

	if = { limit = { has_country_flag = army_size3 NOT = { has_idea = army_size3 } } add_ideas = army_size3 hidden_effect = { remove_ideas = army_size6 remove_ideas = army_size2 remove_ideas = army_size4 remove_ideas = army_size5 remove_ideas = army_size1 remove_ideas = army_size7 remove_ideas = army_size8 } }

	if = { limit = { has_country_flag = army_size4 NOT = { has_idea = army_size4 } } add_ideas = army_size4 hidden_effect = { remove_ideas = army_size6 remove_ideas = army_size2 remove_ideas = army_size3 remove_ideas = army_size5 remove_ideas = army_size1 remove_ideas = army_size7 remove_ideas = army_size8 } }

	if = { limit = { has_country_flag = army_size5 NOT = { has_idea = army_size5 } } add_ideas = army_size5 hidden_effect = { remove_ideas = army_size6 remove_ideas = army_size2 remove_ideas = army_size3 remove_ideas = army_size4 remove_ideas = army_size1 remove_ideas = army_size7 remove_ideas = army_size8 } }

	if = { limit = { has_country_flag = army_size6 NOT = { has_idea = army_size6 } } add_ideas = army_size6 hidden_effect = { remove_ideas = army_size5 remove_ideas = army_size2 remove_ideas = army_size3 remove_ideas = army_size4 remove_ideas = army_size1 remove_ideas = army_size7 remove_ideas = army_size8 } }

	if = { limit = { has_country_flag = army_size7 NOT = { has_idea = army_size7 } } add_ideas = army_size7 hidden_effect = { remove_ideas = army_size5 remove_ideas = army_size2 remove_ideas = army_size3 remove_ideas = army_size4 remove_ideas = army_size1 remove_ideas = army_size6 remove_ideas = army_size8 } }

	if = { limit = { has_country_flag = army_size8 NOT = { has_idea = army_size8 } } add_ideas = army_size8 hidden_effect = { remove_ideas = army_size5 remove_ideas = army_size2 remove_ideas = army_size3 remove_ideas = army_size4 remove_ideas = army_size1 remove_ideas = army_size6 remove_ideas = army_size7 } }

	#Airforce
	if = { limit = { has_country_flag = airforce_size1 NOT = { has_idea = airforce_size1 } } add_ideas = airforce_size1 hidden_effect = { remove_ideas = airforce_size5 remove_ideas = airforce_size6 remove_ideas = airforce_size3 remove_ideas = airforce_size4 remove_ideas = airforce_size2 remove_ideas = airforce_size7 remove_ideas = airforce_size8 } }

	if = { limit = { has_country_flag = airforce_size2 NOT = { has_idea = airforce_size2 } } add_ideas = airforce_size2 hidden_effect = { remove_ideas = airforce_size5 remove_ideas = airforce_size6 remove_ideas = airforce_size3 remove_ideas = airforce_size4 remove_ideas = airforce_size1 remove_ideas = airforce_size7 remove_ideas = airforce_size8 } }

	if = { limit = { has_country_flag = airforce_size3 NOT = { has_idea = airforce_size3 } } add_ideas = airforce_size3 hidden_effect = { remove_ideas = airforce_size5 remove_ideas = airforce_size6 remove_ideas = airforce_size2 remove_ideas = airforce_size4 remove_ideas = airforce_size1 remove_ideas = airforce_size7 remove_ideas = airforce_size8 } }

	if = { limit = { has_country_flag = airforce_size4 NOT = { has_idea = airforce_size4 } } add_ideas = airforce_size4 hidden_effect = { remove_ideas = airforce_size5 remove_ideas = airforce_size6 remove_ideas = airforce_size3 remove_ideas = airforce_size2 remove_ideas = airforce_size1 remove_ideas = airforce_size7 remove_ideas = airforce_size8 } }

	if = { limit = { has_country_flag = airforce_size5 NOT = { has_idea = airforce_size5 } } add_ideas = airforce_size5 hidden_effect = { remove_ideas = airforce_size2 remove_ideas = airforce_size6 remove_ideas = airforce_size3 remove_ideas = airforce_size4 remove_ideas = airforce_size1 remove_ideas = airforce_size7 remove_ideas = airforce_size8 } }

	if = { limit = { has_country_flag = airforce_size6 NOT = { has_idea = airforce_size6 } } add_ideas = airforce_size6 hidden_effect = { remove_ideas = airforce_size5 remove_ideas = airforce_size2 remove_ideas = airforce_size3 remove_ideas = airforce_size4 remove_ideas = airforce_size1 remove_ideas = airforce_size7 remove_ideas = airforce_size8 } }

	if = { limit = { has_country_flag = airforce_size7 NOT = { has_idea = airforce_size7 } } add_ideas = airforce_size7 hidden_effect = { remove_ideas = airforce_size5 remove_ideas = airforce_size2 remove_ideas = airforce_size3 remove_ideas = airforce_size4 remove_ideas = airforce_size1 remove_ideas = airforce_size6 remove_ideas = airforce_size8 } }

	if = { limit = { has_country_flag = airforce_size8 NOT = { has_idea = airforce_size8 } } add_ideas = airforce_size8 hidden_effect = { remove_ideas = airforce_size5 remove_ideas = airforce_size2 remove_ideas = airforce_size3 remove_ideas = airforce_size4 remove_ideas = airforce_size1 remove_ideas = airforce_size6 remove_ideas = airforce_size7 } }

	#Naval

	if = { limit = { has_country_flag = navy_size1 NOT = { has_idea = navy_size1 } } add_ideas = navy_size1 hidden_effect = { remove_ideas = navy_size5 remove_ideas = navy_size6 remove_ideas = navy_size3 remove_ideas = navy_size4 remove_ideas = navy_size2 remove_ideas = navy_size7 remove_ideas = navy_size8 } }

	if = { limit = { has_country_flag = navy_size2 NOT = { has_idea = navy_size2 } } add_ideas = navy_size2 hidden_effect = { remove_ideas = navy_size5 remove_ideas = navy_size6 remove_ideas = navy_size3 remove_ideas = navy_size4 remove_ideas = navy_size1 remove_ideas = navy_size7 remove_ideas = navy_size8 } }

	if = { limit = { has_country_flag = navy_size3 NOT = { has_idea = navy_size3 } } add_ideas = navy_size3 hidden_effect = { remove_ideas = navy_size5 remove_ideas = navy_size6 remove_ideas = navy_size2 remove_ideas = navy_size4 remove_ideas = navy_size1 remove_ideas = navy_size7 remove_ideas = navy_size8 } }

	if = { limit = { has_country_flag = navy_size4 NOT = { has_idea = navy_size4 } } add_ideas = navy_size4 hidden_effect = { remove_ideas = navy_size5 remove_ideas = navy_size6 remove_ideas = navy_size3 remove_ideas = navy_size2 remove_ideas = navy_size1 remove_ideas = navy_size7 remove_ideas = navy_size8 } }

	if = { limit = { has_country_flag = navy_size5 NOT = { has_idea = navy_size5 } } add_ideas = navy_size5 hidden_effect = { remove_ideas = navy_size2 remove_ideas = navy_size6 remove_ideas = navy_size3 remove_ideas = navy_size4 remove_ideas = navy_size1 remove_ideas = navy_size7 remove_ideas = navy_size8 } }

	if = { limit = { has_country_flag = navy_size6 NOT = { has_idea = navy_size6 } } add_ideas = navy_size6 hidden_effect = { remove_ideas = navy_size5 remove_ideas = navy_size2 remove_ideas = navy_size3 remove_ideas = navy_size4 remove_ideas = navy_size1 remove_ideas = navy_size7 remove_ideas = navy_size8 } }

	if = { limit = { has_country_flag = navy_size7 NOT = { has_idea = navy_size7 } } add_ideas = navy_size7 hidden_effect = { remove_ideas = navy_size5 remove_ideas = navy_size2 remove_ideas = navy_size3 remove_ideas = navy_size4 remove_ideas = navy_size1 remove_ideas = navy_size6 remove_ideas = navy_size8 } }

	if = { limit = { has_country_flag = navy_size8 NOT = { has_idea = navy_size8 } } add_ideas = navy_size8 hidden_effect = { remove_ideas = navy_size5 remove_ideas = navy_size2 remove_ideas = navy_size3 remove_ideas = navy_size4 remove_ideas = navy_size1 remove_ideas = navy_size6 remove_ideas = navy_size7 } }
}


RON_change_era_immediate_effects = {

	#Army
	if = {
		limit = {
			date > 1909.12.31
			date < 1919.1.1
		}
		add_ideas = RON_WW1
	}
	if = {
		limit = {
			date > 1918.12.31
			date < 1933.1.1
		}
		add_ideas = RON_Interwar
	}
	if = {
		limit = {
			date > 1932.12.31
			date < 1949.1.1
		}
		add_ideas = RON_WW2
	}
	if = {
		limit = {
			date > 1948.12.31
			date < 1980.1.1
		}
		add_ideas = RON_Cold_War
	}
	if = {
		limit = {
			date > 1979.12.31
			date < 2000.1.1
		}
		add_ideas = RON_Late_Cold_War
	}
	if = {
		limit = {
			date > 1999.12.31
			date < 2020.1.1
		}
		add_ideas = RON_Modern_Day
	}
}

RON_change_era_ok_effects = {

#	#Delete All Unit Leaders Just Once Start of WW2, Cold War and Modern Day For All Countries
	if = {
		limit = {
			OR = {
				AND = {
				date > 1932.12.31
				date < 1949.1.1
				#RON_has_custom_generals_ww2 = yes
				}
				AND = {
				date > 1948.12.31
				date < 2000.1.1
				#RON_has_custom_generals_cw = yes
				}
				AND = {
				date > 1999.12.31
				#RON_has_custom_generals_md = yes
				}
			}
		}
		every_unit_leader = { retire = yes }
	}

	if = {
		limit = {
			RON_Needs_Bonus_Research_Slots = yes
		}
		country_event = { id = change_era.3 hours = 1 }
	}

	if = {
		limit = {
			date > 1909.12.31
			date < 1919.1.1
			RON_has_custom_leaders_ww1 = yes
		}
		RON_handle_ww1_leaders = yes
	}
	if = {
		limit = {
			date > 1909.12.31
			date < 1919.1.1
			RON_has_custom_national_spirits_ww1 = yes
		}
		RON_handle_ww1_national_spirits = yes
	}

	if = {
		limit = {
			date > 1918.12.31
			date < 1933.1.1
			RON_has_custom_leaders_int = yes
		}
		RON_handle_int_leaders = yes
	}
	if = {
		limit = {
			date > 1918.12.31
			date < 1933.1.1
			RON_has_custom_national_spirits_int = yes
		}
		RON_handle_int_national_spirits = yes
	}

	if = {
		limit = {
			date > 1932.12.31
			date < 1949.1.1
			RON_has_custom_leaders_ww2 = yes
		}
		RON_handle_ww2_leaders = yes
	}
	if = {
		limit = {
			date > 1932.12.31
			date < 1949.1.1
			RON_has_custom_national_spirits_ww2 = yes
		}
		RON_handle_ww2_national_spirits = yes
	}

	if = {
		limit = {
			date > 1948.12.31
			date < 1980.1.1
			RON_has_custom_leaders_cw = yes
		}
		RON_handle_cw_leaders = yes
	}
	if = {
		limit = {
			date > 1948.12.31
			date < 1980.1.1
			RON_has_custom_national_spirits_cw = yes
		}
		RON_handle_cw_national_spirits = yes
	}

	if = {
		limit = {
			date > 1979.12.31
			date < 2000.1.1
			RON_has_custom_leaders_lcw = yes
		}
		RON_handle_lcw_leaders = yes
	}
	if = {
		limit = {
			date > 1979.12.31
			date < 2000.1.1
			RON_has_custom_national_spirits_lcw = yes
		}
		RON_handle_lcw_national_spirits = yes
	}

	if = {
		limit = {
			date > 1999.12.31
			RON_has_custom_leaders_md = yes
		}
		RON_handle_md_leaders = yes
	}
	if = {
		limit = {
			date > 1999.12.31
			RON_has_custom_national_spirits_md = yes
		}
		RON_handle_md_national_spirits = yes
	}
	
		#Facu's Event System Properly Implemented
		#WW1 Leaders
		if = {
			limit = {
				date > 1909.12.31
				date < 1919.1.1
			}
			country_event = { id = change_era.6 hours = 1 }
		}
		#Interwar
		if = {
			limit = {
				date > 1918.12.31
				date < 1933.1.1
			}
			country_event = { id = change_era.7 hours = 1 }
		}
		#WW2
		if = {
			limit = {
				date > 1932.12.31
				date < 1949.1.1
			}
			country_event = { id = change_era.8 hours = 1 }
			country_event = { id = change_era.12 hours = 1 }
		}
		#Early Cold War
		if = {
			limit = {
				date > 1948.12.31
				date < 1980.1.1
			}
			country_event = { id = change_era.9 hours = 1 }
			country_event = { id = change_era.13 hours = 1 }
		}
		#Late Cold War
		if = {
			limit = {
				date > 1979.12.31
				date < 2000.1.1
			}
			country_event = { id = change_era.10 hours = 1 }
		}
		#Modern Day
		if = {
			limit = {
				date > 1999.12.31
			}
			country_event = { id = change_era.11 hours = 1 }
			country_event = { id = change_era.14 hours = 1 }
		}

	#Army
	### This changes party names
	if = {
		limit = {
			#RON_party_names_change = yes
		}
		RON_handle_party_names_event = yes
	}
	RON_handle_focus_trees = yes
	### Load Demob Techs WW1
	if = {
		limit = {
			date > 1918.12.31
			date < 1933.1.1
			RON_must_demobilize_ww1 = yes
		}
		country_event = { id = change_era.4 hours = 1 }
	}
	### WW2 Load Custom Focus tree when applicable
	if = {
		limit = {
			date > 1932.12.31
			date < 1949.1.1
			RON_has_focus_tree_WW2 = yes
		}
		RON_handle_WW2_focus_trees = yes
	}
	
	### WW2 Remove All Previous Generals
	if = {
		limit = {
			date > 1932.12.31
			date < 1949.1.1
			RON_has_custom_generals_ww2 = yes
		}
		RON_handle_ww2_generals = yes
	}
	### Cold War
	### Load Demob Techs WW2
	if = {
		limit = {
			date > 1948.12.31
			date < 1980.1.1
			RON_must_demobilize_ww2 = yes
		}
		country_event = { id = change_era.5 hours = 1 }
	}
	# Early Cold War Add Cold War Generals
	if = {
		limit = {
			date > 1948.12.31
			date < 1980.1.1
			RON_has_custom_generals_cw = yes
		}
		RON_handle_cw_generals = yes
	}
	#Cold War add Defcon
	if = {
		limit = {
			date > 1948.12.31
			date < 2000.1.1
			has_idea = nodefcon
		}
		add_ideas = {
			defcon5
		}
	}
	if = {
		limit = {
			date > 1999.12.31
			RON_has_custom_generals_md = yes
		}
		RON_handle_md_generals = yes
	}
	RON_handle_military_experience_gain = yes
	every_country = {
		mark_focus_tree_layout_dirty = yes
	}
}

RON_handle_focuses_on_release = {
	if = {
		limit = {
			date < 1910.1.1
			RON_has_custom_focus_tree = yes
			RON_has_focus_tree_DNC = no
		}
		load_focus_tree = generic_focus
	}

	if = {
		limit = {
			date < 1910.1.1
			RON_has_focus_tree_DNC = no
			RON_democratic_countries_dnc = yes
		}
		load_focus_tree = DNC_democratic_tree
	}

	if = {
		limit = {
			date < 1910.1.1
			RON_has_focus_tree_DNC = no
			RON_neutrality_countries_dnc = yes
		}
		load_focus_tree = DNC_neutral_tree
	}

	if = {
		limit = {
			date > 1909.12.31
			date < 1919.1.1
			RON_has_custom_focus_tree = yes
			RON_has_focus_tree_WW1 = no
		}
		load_focus_tree = RON_Generic_WW1
	}

	if = {
		limit = {
			date > 1918.12.31
			date < 1933.1.1
			RON_has_custom_focus_tree = yes
			RON_has_focus_tree_INT = no
		}
		load_focus_tree = RON_Generic_INT

	}

	if = {
		limit = {
			date > 1932.12.31
			date < 1949.1.1
			RON_has_custom_focus_tree = yes
			RON_has_focus_tree_WW2 = no
		}
		load_focus_tree = RON_Generic_WW2
	}


	if = {
		limit = {
			date > 1948.12.31
			date < 1980.1.1
			RON_has_custom_focus_tree = yes
			RON_has_focus_tree_CW = no
		}
		load_focus_tree = RON_Generic_ECW
	}

	if = {
		limit = {
			date > 1979.12.31
			date < 2000.1.1
			RON_has_custom_focus_tree = yes
			RON_has_focus_tree_LCW = no
		}
		load_focus_tree = RON_Generic_LCW
	}

	if = {
		limit = {
			date > 1999.12.31
			RON_has_custom_focus_tree = yes
			RON_has_focus_tree_MD = no
		}
		load_focus_tree = RON_Generic_MD
	}
}

RON_handle_military_experience_gain = {
	if = {
		limit = {
			has_idea = army_budget1
		}
		army_experience = 100
	}
	else_if = {
		limit = {
			has_idea = army_budget2
		}
		army_experience = 200
	}
	else_if = {
		limit = {
			has_idea = army_budget3
		}
		army_experience = 300
	}
	else_if = {
		limit = {
			has_idea = army_budget4
		}
		army_experience = 400
	}
	else_if = {
		limit = {
			has_idea = army_budget5
		}
		army_experience = 500
	}
	else_if = {
		limit = {
			has_idea = army_budget6
		}
		army_experience = 600
	}
	else_if = {
		limit = {
			has_idea = army_budget7
		}
		army_experience = 700
	}
	
	if = {
		limit = {
			has_idea = navy_budget1
		}
		navy_experience = 100
	}
	else_if = {
		limit = {
			has_idea = navy_budget2
		}
		navy_experience = 200
	}
	else_if = {
		limit = {
			has_idea = navy_budget3
		}
		navy_experience = 300
	}
	else_if = {
		limit = {
			has_idea = navy_budget4
		}
		navy_experience = 400
	}
	else_if = {
		limit = {
			has_idea = navy_budget5
		}
		navy_experience = 500
	}
	else_if = {
		limit = {
			has_idea = navy_budget6
		}
		navy_experience = 600
	}
	else_if = {
		limit = {
			has_idea = navy_budget7
		}
		navy_experience = 700
	}
	
	if = {
		limit = {
			has_idea = airforce_budget1
		}
		air_experience = 100
	}
	else_if = {
		limit = {
			has_idea = airforce_budget2
		}
		air_experience = 200
	}
	else_if = {
		limit = {
			has_idea = airforce_budget3
		}
		air_experience = 300
	}
	else_if = {
		limit = {
			has_idea = airforce_budget4
		}
		air_experience = 400
	}
	else_if = {
		limit = {
			has_idea = airforce_budget5
		}
		air_experience = 500
	}
	else_if = {
		limit = {
			has_idea = airforce_budget6
		}
		air_experience = 600
	}
	else_if = {
		limit = {
			has_idea = airforce_budget7
		}
		air_experience = 700
	}

}

RON_welcome_ok_effects = {

		country_event = {
			id = power_status.1 hours = 6
		}

		if = {
			limit = {
				is_start_date_with_content = no
			}
			#country_event = {
			#	id = ron_welcomeevents.2
			#}
		}
		
		if = {
			limit = {
				date > 1941.1.1
				date < 1942.1.1
			}
			every_country = {
				set_country_flag = load_WW2_generals
			}
		}
		
		if = {
			limit = {
				date > 1942.1.1
				date < 1943.1.1
			}
			every_country = {
				set_country_flag = load_WW2_generals
			}
		}
		
		if = {
			limit = {
				date > 1943.1.1
				date < 1944.1.1
			}
			every_country = {
				set_country_flag = load_WW2_generals
			}
		}
		
		if = {
			limit = {
				date > 1944.1.1
				date < 1945.1.1
			}
			every_country = {
				set_country_flag = load_WW2_generals
			}
		}

		if = {
			limit = {
				RON_must_give_russia_winter_idea = yes
				NOT = { has_global_flag = RON_weather_report_in_progress }
			}
			RON_give_russian_winter_event = yes
		}

		if = {
			limit = {
				date > 1948.12.31
				date < 2000.1.1
			}
			
		}
		if = {
			limit = {
				
				date > 1999.12.31
			}
			
		}
}

RON_welcome_advanced_effects = {

	RON_welcome_ok_effects = yes
	#Custom Peacedeals
	#country_event = {
	#		id = ron_welcomeevents.3
	#}
	#country_event = {
	#	id = ron_welcomeevents.4
	#}
	#Custom Gamemodes	
	#if = {
	#	limit = {
	#		is_start_date_with_custom_gamemodes = yes
	#	}
	#	country_event = {
	#		id = ron_welcomeevents.99
	#	}
	#}
	#Type of Gameplay
	#country_event = { id = ron_welcomeevents.105 }	

}
#THIS is state
decrease_population_on_nuke = {
	log = "[GetDateText]: Nuke dropped on [This.GetName], owner [This.owner.GetName], dropped by [Root.GetName]"
	set_temp_variable = { temp_var = random } #0 to 1
	owner = { set_temp_variable = { PREV.prenuke_country_manpower = manpower_k } }
	if = {
		limit = { state_population > 999999 }
		set_temp_variable = { pop_to_kill = state_population_k }
		set_state_flag = state_population_thousands
	}
	else = {
		set_temp_variable = { pop_to_kill = state_population }
	}
	if = {
		limit = { has_state_category = megalopolis } #20 kt bomb in a very dense urban region - 250,000 - 300,000 casualties
		multiply_temp_variable = { temp_var = 50000 } # 300,000 - 250,000
		add_to_temp_variable = { temp_var = 250000 }
		set_temp_variable = { pop_to_kill = temp_var }
		clr_state_flag = state_population_thousands
		if = {
			limit = {
				OR  = {
					state_population < 800000
					has_state_flag = recently_nuked
				}
			}
			set_temp_variable = { temp_var = random } #0 to 1
			multiply_temp_variable = { temp_var = 0.07 } # 0.1 - 0.05
			add_to_temp_variable = { temp_var = 0.07 }
			multiply_temp_variable = { pop_to_kill = temp_var }
		}
	}
	else_if = {
		limit = { has_state_category = metropolis } #20 kt bomb in a dense urban region - 175,000 - 250,000 casualties
		multiply_temp_variable = { temp_var = 75000 } # 250,000 - 175,000
		add_to_temp_variable = { temp_var = 175000 }
		set_temp_variable = { pop_to_kill = temp_var }
		clr_state_flag = state_population_thousands
		if = {
			limit = {
				OR  = {
					state_population < 600000
					has_state_flag = recently_nuked
				}
			}
			set_temp_variable = { temp_var = random } #0 to 1
			multiply_temp_variable = { temp_var = 0.07 } # 0.1 - 0.05
			add_to_temp_variable = { temp_var = 0.07 }
			multiply_temp_variable = { pop_to_kill = temp_var }
		}
	}
	else_if = {
		limit = { has_state_category = large_city } #20 kt bomb in an urban region - 100,000 - 150,000 casualties
		multiply_temp_variable = { temp_var = 75000 } # 250,000 - 175,000
		add_to_temp_variable = { temp_var = 175000 }
		set_temp_variable = { pop_to_kill = temp_var }
		clr_state_flag = state_population_thousands
		if = {
			limit = {
				OR  = {
					state_population < 500000
					has_state_flag = recently_nuked
				}
			}
			set_temp_variable = { temp_var = random } #0 to 1
			multiply_temp_variable = { temp_var = 0.07 } # 0.1 - 0.05
			add_to_temp_variable = { temp_var = 0.07 }
			multiply_temp_variable = { pop_to_kill = temp_var }
		}
	}
	else_if = {
		limit = { has_state_category = city } #20 kt bomb in a sparse urban region - 50,000 - 100,000 casualties
		multiply_temp_variable = { temp_var = 50000 } # 100,000 - 50,000
		add_to_temp_variable = { temp_var = 50000 }
		set_temp_variable = { pop_to_kill = temp_var }
		clr_state_flag = state_population_thousands
		if = {
			limit = {
				OR  = {
					state_population < 500000
					has_state_flag = recently_nuked
				}
			}
			set_temp_variable = { temp_var = random } #0 to 1
			multiply_temp_variable = { temp_var = 0.07 } # 0.1 - 0.05
			add_to_temp_variable = { temp_var = 0.07 }
			multiply_temp_variable = { pop_to_kill = temp_var }
		}
	}
	else_if = {
		limit = { has_state_category = large_town } #20 kt bomb in a very sparse urban region - 20,000 - 80,000 casualties
		multiply_temp_variable = { temp_var = 70000 } # 80,000 - 20,000
		add_to_temp_variable = { temp_var = 30000 }
		set_temp_variable = { pop_to_kill = temp_var }
		clr_state_flag = state_population_thousands
		if = {
			limit = {
				OR  = {
					state_population < 400000
					has_state_flag = recently_nuked
				}
			}
			set_temp_variable = { temp_var = random } #0 to 1
			multiply_temp_variable = { temp_var = 0.07 } # 0.1 - 0.05
			add_to_temp_variable = { temp_var = 0.07 }
			multiply_temp_variable = { pop_to_kill = temp_var }
		}
	}
	else_if = {
		limit = { has_state_category = town } #20 kt bomb in a developed rural region - 20,000 - 50,000 casualties
		multiply_temp_variable = { temp_var = 30000 } # 50,000 - 20,000
		add_to_temp_variable = { temp_var = 20000 }
		set_temp_variable = { pop_to_kill = temp_var }
		clr_state_flag = state_population_thousands
		if = {
			limit = {
				OR  = {
					state_population < 300000
					has_state_flag = recently_nuked
				}
			}
			set_temp_variable = { temp_var = random } #0 to 1
			multiply_temp_variable = { temp_var = 0.05 } # 0.1 - 0.05
			add_to_temp_variable = { temp_var = 0.05 }
			multiply_temp_variable = { pop_to_kill = temp_var }
		}
	}
	else_if = {
		limit = { has_state_category = rural } #20 kt bomb in a rural region - 5,000 - 25,000 casualties
		multiply_temp_variable = { temp_var = 20000 } # 25,000 - 5,000
		add_to_temp_variable = { temp_var = 5000 }
		set_temp_variable = { pop_to_kill = temp_var }
		clr_state_flag = state_population_thousands
		if = {
			limit = {
				OR  = {
					state_population < 200000
					has_state_flag = recently_nuked
				}
			}
			set_temp_variable = { temp_var = random } #0 to 1
			multiply_temp_variable = { temp_var = 0.05 } # 0.1 - 0.05
			add_to_temp_variable = { temp_var = 0.05 }
			multiply_temp_variable = { pop_to_kill = temp_var }
		}
	}
	else_if = {
		limit = { has_state_category = pastoral } #20 kt bomb in a sparse rural region - 500 - 2,500 casualties
		multiply_temp_variable = { temp_var = 1000 } # 2500 - 500
		add_to_temp_variable = { temp_var = 500 }
		set_temp_variable = { pop_to_kill = temp_var }
		clr_state_flag = state_population_thousands
		if = {
			limit = {
				OR  = {
					state_population < 200000
					has_state_flag = recently_nuked
				}
			}
			set_temp_variable = { temp_var = random } #0 to 1
			multiply_temp_variable = { temp_var = 0.05 } # 0.1 - 0.05
			add_to_temp_variable = { temp_var = 0.05 }
			multiply_temp_variable = { pop_to_kill = temp_var }
		}
	}
	else_if = {
		limit = { has_state_category = small_island } #20 kt bomb on a small island - 20% - 50%
		multiply_temp_variable = { temp_var = 0.3 } # 0.5 - 0.2
		add_to_temp_variable = { temp_var = 0.2 }
		multiply_temp_variable = { pop_to_kill = temp_var }
		if = {
			limit = {
				has_state_flag = recently_nuked
			}
			multiply_temp_variable = { pop_to_kill = 0.2 }
		}
	}
	else_if = {
		limit = { has_state_category = tiny_island } #20 kt bomb on a tiny island - 30% - 75%
		multiply_temp_variable = { temp_var = 0.45 } # 0.75 - 0.3
		add_to_temp_variable = { temp_var = 0.3 }
		multiply_temp_variable = { pop_to_kill = temp_var }
		if = {
			limit = {
				has_state_flag = recently_nuked
			}
			multiply_temp_variable = { pop_to_kill = 0.2 }
		}
	}
	else_if = {
		limit = { has_state_category = wasteland } #20 kt bomb on a literally nothing - 0 - 1%
		multiply_temp_variable = { pop_to_kill = temp_var }
		if = {
			limit = {
				has_state_flag = recently_nuked
			}
			multiply_temp_variable = { pop_to_kill = 0.2 }
		}
	}
	else_if = {
		limit = { has_state_category = enclave } #20 kt bomb on a an enclave - 40% - 75%
		multiply_temp_variable = { temp_var = 0.35 } # 0.75 - 0.4
		add_to_temp_variable = { temp_var = 0.4 }
		multiply_temp_variable = { pop_to_kill = temp_var }
		if = {
			limit = {
				has_state_flag = recently_nuked
			}
			multiply_temp_variable = { pop_to_kill = 0.2 }
		}
	}
	if = {
		limit = { PREV = { has_tech = RON_Thermonuclear_Bomb } } #25kt - 30kt
		multiply_temp_variable = { pop_to_kill = 1.1 }
	}
	if = {
		limit = { PREV = { has_tech = RON_Thermonuclear_Bomb2 } } #30kt - 35kt
		multiply_temp_variable = { pop_to_kill = 1.1 }
	}
	if = {
		limit = {
			has_state_flag = state_population_thousands
		}
		log = "Nuke dropped on [This.GetName], state_population_thousands, expected [?pop_to_kill]*1000 casualties"
		while_loop_effect = {
			limit = { check_variable = { pop_to_kill > 999 } }
			log = "Nuke dropped on [This.GetName], 1000000 dead"
			subtract_from_temp_variable = { pop_to_kill = 1000 }
			add_manpower = -1000000
		}
		multiply_temp_variable = { pop_to_kill = 1000 }
	}
	round_temp_variable = pop_to_kill
	log = "Nuke dropped on [This.GetName], [?pop_to_kill] dead"
	multiply_temp_variable = { pop_to_kill = -1 }
	add_manpower = pop_to_kill

	#take care of country manpower change
	owner = { set_temp_variable = { PREV.afternuke_country_manpower = manpower_k } }
	log = "Nuke dropped on [This.GetName], prenuke_country_manpower [?prenuke_country_manpower], afternuke_country_manpower [?afternuke_country_manpower]"
	subtract_from_temp_variable = { afternuke_country_manpower = prenuke_country_manpower }
	while_loop_effect = {
		limit = { check_variable = { afternuke_country_manpower > 9 } }
		log = "Nuke dropped on [This.GetName], afternuke_country_manpower adjustment, 10000 removed"
		subtract_from_temp_variable = { afternuke_country_manpower = 10 }
		owner = { add_manpower = -10000 }
	}
	multiply_temp_variable = { afternuke_country_manpower = 1000 }
	round_temp_variable = afternuke_country_manpower
	log = "Nuke dropped on [This.GetName], afternuke_country_manpower adjustment, [?afternuke_country_manpower] removed"
	multiply_temp_variable = { afternuke_country_manpower = -1 }
	owner = { add_manpower = afternuke_country_manpower }

	if = {
		limit = {
			NOT = { has_state_flag = recently_nuked }
		}
		log = "Nuke dropped on [This.GetName], not recently nuked"
		#add_province_modifier = {
		#	static_modifiers = { nuked }
		#	province = {
		#		all_provinces = yes
		#	}
		#}
		add_state_modifier = {
			modifier = {
				local_supplies = -0.35
				local_factories = -0.15
			}
		}
		set_state_flag = nuke_modifier
	}
	set_state_flag = { flag = recently_nuked value = 1 days = 360 }
	clr_state_flag = state_population_thousands
	owner = { country_event = { id =  r56i.event.22 days = 361 } }
}